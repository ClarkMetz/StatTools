<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Statistics Applets HUB</title>
  <style>
    :root{
      --wvu-blue:#002855;
      --wvu-gold:#EAAA00;
      --bg:#ffffff;
      --panel:#f7f7f9;
      --text:#111827;
      --muted:#6b7280;
      --border:#d1d5db;
      --shadow:0 10px 24px rgba(0,0,0,.08);
      --radius:14px;
      --left-width:280px;
      --menu-font:14px;
    }
    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family: Arial, Helvetica, sans-serif;
      color:var(--text);
      background:var(--bg);
    }

    .wrap{
      max-width:1100px;
      margin:8px auto 28px;
      padding:0 18px;
      display:grid;
      grid-template-columns: var(--left-width) 8px 1fr;
      gap:0;
      align-items:start;
    }
    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
    }

    .card{
      background:var(--panel);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .section-head{
      padding:12px 14px;
      background:rgba(0,40,85,.06);
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .section-head h2{
      margin:0;
      font-size:14px;
      color:var(--wvu-blue);
      letter-spacing:.2px;
    }
    .small{
      font-size:12px;
      color:var(--muted);
    }

    .menu{
      font-size:var(--menu-font);
      padding:10px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    details{
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      overflow:hidden;
    }
    summary{
      list-style:none;
      cursor:pointer;
      padding:12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      font-weight:700;
      color:var(--wvu-blue);
    }
    summary::-webkit-details-marker{display:none;}
    .chev{
      width:10px; height:10px;
      border-right:2px solid var(--muted);
      border-bottom:2px solid var(--muted);
      transform:rotate(-45deg);
      transition:transform .15s ease;
      margin-left:auto;
    }
    details[open] .chev{ transform:rotate(45deg); }

    .tool-list{
      padding:8px 10px 12px;
      display:flex;
      flex-direction:column;
      gap:6px;
      border-top:1px solid var(--border);
      background:#fff;
    }

    .tool-link a{
      display:block;
      padding:10px 10px;
      border-radius:10px;
      text-decoration:none;
      color:var(--wvu-blue);
      border:1px solid rgba(0,40,85,.14);
      background:rgba(0,40,85,.03);
    }
    .tool-link a:hover{ background:rgba(234,170,0,.18); border-color:rgba(234,170,0,.6); }
    .tool-link a.visited,
    .tool-link a:visited{ color:#6b21a8; }

    /* De-emphasize Reference section */
    details[data-group="ref"] summary{
      font-weight:400;
      font-size:13px;
      color:var(--muted);
    }
    details[data-group="ref"]{
      border-style:dashed;
      opacity:0.9;
    }
    details[data-group="ref"] .tool-link a{
      font-size:13px;
      padding:8px 10px;
    }

    .viewer{
      position:sticky;
      top:14px;
    }
    @media (max-width: 980px){
      .viewer{ position:static; }
    }

    iframe{
      min-width:200px;
      width:100%;
      height:1200px;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
    }
    @media (max-width: 980px){
      iframe{ height:650px; }
    }

    /* Hidden template slots (filled by you later) */
    template.inline-tool{ display:none; }

    /* Draggable resizer */
    .resizer{
      cursor:col-resize;
      background:linear-gradient(to right, transparent, rgba(0,0,0,.08), transparent);
      width:8px;
      height:100%;
      align-self:stretch;
    }
    .resizer:hover{ background:rgba(0,0,0,.12); }
    @media (max-width: 980px){
      .resizer{ display:none; }
    }
  </style>
</head>
<body>

  <main class="wrap">
    <!-- LEFT: MENU -->
       <section class="card">
      <details class="tools-pane" open>
        <summary class="section-head">
          <h2>Tools</h2>
          <span class="chev" aria-hidden="true"></span>
        </summary>

        <div class="menu">
          <details data-group="distribution">
            <summary>Distribution calculators <span class="chev" aria-hidden="true"></span></summary>
            <div class="tool-list">
              <div class="tool-link"><a data-tool="normal" href="#">Normal Distribution</a></div>
              <div class="tool-link"><a data-tool="t" href="#">t Distribution</a></div>
              <div class="tool-link"><a data-tool="chisq" href="#">Chi-Square Distribution</a></div>
              <div class="tool-link"><a data-tool="f" href="#">F Distribution</a></div>
              <div class="tool-link"><a data-tool="beta" href="#">Beta Distribution</a></div>
              <div class="tool-link"><a data-tool="gamma" href="#">Gamma Distribution</a></div>
              <div class="tool-link"><a data-tool="exp" href="#">Exponential Distribution</a></div>
              <div class="tool-link"><a data-tool="weibull" href="#">Weibull Distribution</a></div>
              <div class="tool-link"><a data-tool="lognormal" href="#">Lognormal Distribution</a></div>
              <div class="tool-link"><a data-tool="cauchy" href="#">Cauchy Distribution</a></div>
              <div class="tool-link"><a data-tool="uniform" href="#">Uniform Distribution</a></div>
            </div>
          </details>

          <details data-group="interval">
            <summary>Estimation &amp; Hypothesis Testing <span class="chev" aria-hidden="true"></span></summary>
            <div class="tool-list">
              <div class="tool-link"><a data-tool="ci" href="#">Confidence Interval Calculator</a></div>
              <div class="tool-link"><a data-tool="ht" href="#">Hypothesis Testing Calculator</a></div>
            </div>
          </details>

          <details data-group="chisq">
            <summary>Chi-square tests <span class="chev" aria-hidden="true"></span></summary>
            <div class="tool-list">
              <div class="tool-link"><a data-tool="indep" href="#">Chi-Square Test of Independence</a></div>
              <div class="tool-link"><a data-tool="gof" href="#">Chi-Square Goodness-of-Fit</a></div>
            </div>
          </details>

          <details data-group="ref">
            <summary>Reference <span class="chev" aria-hidden="true"></span></summary>
            <div class="tool-list">
              <div class="tool-link"><a data-tool="distref" href="#">Distribution Calculator Overview</a></div>
              <div class="tool-link"><a data-tool="excelref" href="#">Useful Excel Formulas</a></div>
            </div>
          </details>
        </div>
      </details>
    </section>

    <!-- RESIZER COLUMN -->
    <div class="resizer" id="resizer" aria-hidden="true"></div>

    <!-- RIGHT: VIEWER -->
    <section class="card viewer">
      <div class="section-head">
        <h2 id="viewerTitle">Select a tool</h2>
        <span id="status" class="small">Ready</span>
      </div>
      <div class="frame-wrap" style="padding:12px;">
        <iframe id="toolFrame" title="STAT 211 Tool"></iframe>
      </div>
    </section>
  </main>

  <script>
    // DOM refs (declare ONCE)
    const toolFrame = document.getElementById('toolFrame');
    const viewerTitle = document.getElementById('viewerTitle');
    const statusEl = document.getElementById('status');

    // Map tool keys -> template ids (you'll fill each template's inner HTML)
    const TOOL_TEMPLATES = {
      distref: 'TPL_DIST_REF',
      excelref: 'TPL_EXCEL_REF',
      normal: 'TPL_NORMAL',
      t: 'TPL_T',
      chisq: 'TPL_CHISQ',
      f: 'TPL_F',
      beta: 'TPL_BETA',
      gamma: 'TPL_GAMMA',
      exp: 'TPL_EXP',
      weibull: 'TPL_WEIBULL',
      lognormal: 'TPL_LOGNORMAL',
      cauchy: 'TPL_CAUCHY',
      uniform: 'TPL_UNIFORM',
      ci: 'TPL_CI',
      ht: 'TPL_HT',
      indep: 'TPL_INDEP',
      gof: 'TPL_GOF'
    };

    // One-line descriptions shown after load
    const TOOL_DESCRIPTIONS = {
      normal: 'Compute probabilities and explore properties of the normal distribution.',
      t: 'Compute probabilities and critical values for the t distribution.',
      chisq: 'Compute probabilities and explore properties of the chi-square distribution.',
      f: 'Compute probabilities and critical values for the F distribution.',
      beta: 'Model probabilities on the interval (0, 1) using the beta distribution.',
      gamma: 'Model continuous positive data using the gamma distribution.',
      exp: 'Model events using the exponential distribution.',
      weibull: 'Model data using the Weibull distribution.',
      lognormal: 'Model positively skewed data using the lognormal distribution.',
      cauchy: 'Explore the properties of the heavy-tailed Cauchy distribution.',
      uniform: 'Compute probabilities for a continuous uniform distribution.',
      ci: 'Construct and interpret confidence intervals for means and proportions.',
      ht: 'Perform hypothesis tests for means and proportions, including one-sample and two-sample procedures.',
      indep: 'Test for association between two categorical variables using a chi-square test of independence.',
      gof: 'Assess how well observed data fit a hypothesized distribution using a chi-square goodness-of-fit test.',
      distref: 'Overview of how to use and interpret the distribution calculators provided in this hub.',
      excelref: 'Summary of commonly used Excel formulas relevant to STAT 211.'
    };

    function setStatus(msg){ statusEl.textContent = msg; }

    // After an iframe load completes, show the tool description (set during loadTool)
    let pendingDesc = '';
    toolFrame.addEventListener('load', () => {
      if(pendingDesc){
        setStatus(pendingDesc);
      }
    });

    function loadTool(toolKey, label){
      const tplId = TOOL_TEMPLATES[toolKey];
      const tpl = document.getElementById(tplId);
      viewerTitle.textContent = label;

      if(!tpl){
        setStatus('Missing template.');
        pendingDesc = '';
        toolFrame.srcdoc = '<!doctype html><meta charset="utf-8"><div style="font-family:Arial;padding:18px">Template <b>' + (tplId || 'UNKNOWN') + '</b> not found.</div>';
        return;
      }

      const html = (tpl.innerHTML || '').trim();
      if(!html || html.includes('__INLINE_') || html.includes('__TPL_')){
        setStatus('Template is empty.');
        pendingDesc = '';
        toolFrame.srcdoc = '<!doctype html><meta charset="utf-8"><div style="font-family:Arial;padding:18px;line-height:1.4">'
          + '<b>' + label + '</b> is not pasted into the hub yet.<br/><br/>'
          + 'Paste the full HTML into <code>&lt;template id="' + tplId + '"&gt;</code> at the bottom of this file.'
          + '</div>';
        return;
      }

      pendingDesc = TOOL_DESCRIPTIONS[toolKey] || 'Tool loaded.';
      setStatus('Loading...');
      toolFrame.srcdoc = html;

      // Fallback: if the load event is delayed/blocked, still update status shortly after.
      setTimeout(() => {
        if(statusEl.textContent === 'Loading...'){
          setStatus(pendingDesc);
        }
      }, 250);

      const a = document.querySelector('a[data-tool="' + toolKey + '"]');
      if(a) a.classList.add('visited');
    }

    // Wire clicks
    document.querySelectorAll('a[data-tool]').forEach(a => {
      a.addEventListener('click', (e) => {
        e.preventDefault();
        loadTool(a.dataset.tool, a.textContent.trim());
      });
    });

    // Draggable resizer for left pane
    const resizer = document.getElementById('resizer');
    let isResizing = false;

    if(resizer){
      resizer.addEventListener('mousedown', () => {
        isResizing = true;
        document.body.style.cursor = 'col-resize';
        document.body.style.userSelect = 'none';
      });

      document.addEventListener('mousemove', (e) => {
        if(!isResizing) return;
        const wrapRect = document.querySelector('.wrap').getBoundingClientRect();
        const raw = e.clientX - wrapRect.left;
        const newWidth = Math.min(520, Math.max(220, raw));
        document.documentElement.style.setProperty('--menu-font', newWidth < 300 ? '13px' : '14px');
        document.documentElement.style.setProperty('--left-width', newWidth + 'px');
      });

      document.addEventListener('mouseup', () => {
        if(isResizing){
          isResizing = false;
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
        }
      });
if (window.innerWidth < 980) {
  document.querySelector('.viewer')
    .scrollIntoView({ behavior: 'smooth' });
}

    }

// Accordion behavior for tool groups (only one open at a time)
const toolGroups = document.querySelectorAll('.menu > details');

toolGroups.forEach(group => {
  group.addEventListener('toggle', () => {
    if (!group.open) return;

    toolGroups.forEach(other => {
      if (other !== group) {
        other.open = false;
      }
    });
  });
});

    // Lightweight self-tests (console only)
    function runSelfTests(){
      console.assert(!!toolFrame, 'toolFrame element missing');
      console.assert(!!viewerTitle, 'viewerTitle element missing');
      console.assert(!!statusEl, 'status element missing');
      console.assert(typeof TOOL_TEMPLATES === 'object', 'TOOL_TEMPLATES missing');
      console.assert(Object.keys(TOOL_TEMPLATES).includes('normal'), 'TOOL_TEMPLATES missing normal');
      console.assert(TOOL_TEMPLATES.normal === 'TPL_NORMAL', 'normal template id mismatch');
      console.assert(typeof TOOL_DESCRIPTIONS.ht === 'string' && TOOL_DESCRIPTIONS.ht.length > 0, 'HT description missing');
      console.assert(typeof TOOL_DESCRIPTIONS.normal === 'string' && TOOL_DESCRIPTIONS.normal.length > 0, 'Normal description missing');
    }

    runSelfTests();


  </script>

  <!-- =========================================================
       INLINE TOOL TEMPLATES (PASTE FULL HTML INTO EACH ONE)
       IMPORTANT: Keep each tool as a full standalone HTML doc.
       ========================================================= -->

  <template id="TPL_NORMAL" class="inline-tool">
<html>

<head>
    <title>Normal Distribution Calculator</title>
    <style>
        #calculator {
            width: 600px;
            margin: 20px auto;
            border: 1px solid #ccc;
            padding: 20px;
            text-align: center;
        }

        .input-group {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .input-group label {
            margin-right: 5px;
            white-space: nowrap;
        }

        #probability-input {
            margin: 20px 0;
            padding: 10px;
            border: 2px solid #007bff;
            background-color: #e7f3ff;
            font-weight: bold;
            font-size: 16px;
            white-space: nowrap;
        }

        #distributionChart {
            margin-top: 15px;
        }

        button {
            display: inline-block;
            margin: 5px;
            padding: 5px 15px;
            font-size: 14px;
            cursor: pointer;
        }

        button.active {
            background-color: #007bff;
            color: white;
        }

        #button-container {
            margin-bottom: 20px;
        }

        input[type="number"] {
            width: 80px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
</head>

<body>
    <div id="calculator">
        <h2>Normal Distribution Calculator</h2>
        <div id="button-container">
            <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
            <button id="betweenButton" onclick="setMode('between')">Between</button>
        </div>
        <div class="input-group"><label for="mean">Mean (μ):</label><input type="number" id="mean" value="0"></div>
        <div class="input-group"><label for="stddev">Std. Dev. (σ):</label><input type="number" id="stddev" value="1"
                min="0.0001" step="0.0001"></div>
        <div id="probability-input">
            <span id="standard-inputs">
                P(X <select id="comparison-operator">
                    <option value="less">&le;</option>
                    <option value="greater">&ge;</option>
                </select><input type="number" id="x">) = <input type="number" id="probability" step="0.0001">
            </span>
            <span id="between-inputs" style="display: none;">
                P(<input type="number" id="lower-x"> &le; X &le; <input type="number" id="upper-x">) = <input type="number"
                    id="between-probability" step="0.0001">
            </span>
        </div>
        <button onclick="calculate()">Compute</button>
        <canvas id="distributionChart" width="500" height="300"></canvas>
    </div>

    <script>
        let myChart;
        let mode = 'standard';

        function setMode(selectedMode) {
            mode = selectedMode;
            document.getElementById('standardButton').classList.toggle('active', mode === 'standard');
            document.getElementById('betweenButton').classList.toggle('active', mode === 'between');
            document.getElementById('standard-inputs').style.display = mode === 'standard' ? 'inline' : 'none';
            document.getElementById('between-inputs').style.display = mode === 'between' ? 'inline' : 'none';
            removeShading();
        }

        function initializeChart() {
            const ctx = document.getElementById('distributionChart').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: 'Normal Distribution',
                        data: [],
                        borderColor: 'blue',
                        borderWidth: 2,
                        fill: false,
                        type: 'line',
                        pointRadius: 0
                    },
                    {
                        label: 'Shaded Region',
                        data: [],
                        borderColor: 'rgba(0,0,0,0)',
                        backgroundColor: 'rgba(0, 0, 255, 0.3)',
                        fill: true,
                        type: 'line',
                        pointRadius: 0
                    }]
                },
                options: {
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: { display: true, text: 'X' }
                        },
                        y: { beginAtZero: true }
                    }
                }
            });
        }

        function updateChart(mean, stddev, x = null, isLess = true) {
            const data = [];
            const shadedData = [];
            const minX = mean - 3 * stddev;
            const maxX = mean + 3 * stddev;
            const step = (maxX - minX) / 100;

            for (let i = minX; i <= maxX; i += step) {
                let y = jStat.normal.pdf(i, mean, stddev);
                data.push({ x: i, y: y });
                if (x !== null && ((isLess && i <= x) || (!isLess && i >= x))) {
                    shadedData.push({ x: i, y: y });
                }
            }

            const isStandardNormal = mean === 0 && stddev === 1;
            const chartLabel = isStandardNormal ? 'Standard Normal Distribution' : `Normal Distribution (μ=${mean}, σ=${stddev})`;
            const xAxisLabel = isStandardNormal ? 'Z' : 'X';

            myChart.data.datasets[0].data = data;
            myChart.data.datasets[0].label = chartLabel;
            myChart.options.scales.x.title.text = xAxisLabel;
            myChart.options.scales.x.min = minX;
            myChart.options.scales.x.max = maxX;
            myChart.data.datasets[1].data = shadedData;
            myChart.update();
        }

        function removeShading() {
            if (myChart) {
                myChart.data.datasets[1].data = [];
                myChart.update();
            }
        }

        document.getElementById('mean').addEventListener('input', () => {
            document.getElementById('probability').value = "";
            document.getElementById('between-probability').value = "";
            const mean = parseFloat(document.getElementById('mean').value);
            const stddev = parseFloat(document.getElementById('stddev').value);
            if (stddev > 0) {
                updateChart(mean, stddev);
            }
        });

        document.getElementById('stddev').addEventListener('input', () => {
            document.getElementById('probability').value = "";
            document.getElementById('between-probability').value = "";
            const mean = parseFloat(document.getElementById('mean').value);
            const stddev = parseFloat(document.getElementById('stddev').value);
            if (stddev > 0) {
                updateChart(mean, stddev);
            }
        });

        document.getElementById('x').addEventListener('input', () => {
            document.getElementById('probability').value = "";
            removeShading();
        });

        document.getElementById('probability').addEventListener('input', () => {
            document.getElementById('x').value = "";
            removeShading();
        });

        document.getElementById('comparison-operator').addEventListener('change', () => {
            document.getElementById('probability').value = "";
            removeShading();
        });

        document.getElementById('lower-x').addEventListener('input', () => {
            document.getElementById('between-probability').value = "";
            removeShading();
        });

        document.getElementById('upper-x').addEventListener('input', () => {
            document.getElementById('between-probability').value = "";
            removeShading();
        });

        document.getElementById('between-probability').addEventListener('input', () => {
            document.getElementById('lower-x').value = "";
            document.getElementById('upper-x').value = "";
            removeShading();
        });

        document.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                calculate();
            }
        });

        function calculate() {
            const mean = parseFloat(document.getElementById('mean').value);
            const stddev = parseFloat(document.getElementById('stddev').value);

            if (stddev <= 0) { alert("Standard deviation must be greater than 0."); return; }

            if (mode === 'standard') {
                const xInput = document.getElementById('x');
                const probabilityInput = document.getElementById('probability');
                const comparison = document.getElementById('comparison-operator').value;

                if (!xInput.value && !probabilityInput.value) { alert("Enter x-value or probability."); return; }

                if (xInput.value) {
                    const x = parseFloat(xInput.value);
                    const z = (x - mean) / stddev;
                    let probability = comparison === 'less' ? jStat.normal.cdf(z, 0, 1) : 1 - jStat.normal.cdf(z, 0, 1);
                    probabilityInput.value = roundDisplayValue(probability);
                    updateChart(mean, stddev, x, comparison === 'less');
                } else {
                    let probability = parseFloat(probabilityInput.value);
                    if (isNaN(probability) || probability < 0 || probability > 1) { alert("Enter a valid probability (0-1)."); return; }
                    let z = comparison === 'less' ? jStat.normal.inv(probability, 0, 1) : jStat.normal.inv(1 - probability, 0, 1);
                    xInput.value = roundDisplayValue(mean + z * stddev);
                    updateChart(mean, stddev, mean + z * stddev, comparison === 'less');
                }
            } else if (mode === 'between') {
                const lowerXInput = document.getElementById('lower-x');
                const upperXInput = document.getElementById('upper-x');
                const probabilityInput = document.getElementById('between-probability');

                if (probabilityInput.value) {
                    let probability = parseFloat(probabilityInput.value);
                    if (isNaN(probability) || probability <= 0 || probability >= 1) { alert("Enter a valid probability (0-1)."); return; }

                    const z = jStat.normal.inv((1 + probability) / 2, 0, 1);
                    const lowerX = mean - z * stddev;
                    const upperX = mean + z * stddev;

                    lowerXInput.value = roundDisplayValue(lowerX);
                    upperXInput.value = roundDisplayValue(upperX);

                    updateChartBetween(mean, stddev, lowerX, upperX);
                } else {
                    if (!lowerXInput.value || !upperXInput.value) { alert("Enter both lower and upper x-values."); return; }

                    const lowerX = parseFloat(lowerXInput.value);
                    const upperX = parseFloat(upperXInput.value);

                    if (lowerX >= upperX) { alert("Upper x must be greater than lower x."); return; }

                    const lowerZ = (lowerX - mean) / stddev;
                    const upperZ = (upperX - mean) / stddev;

                    let probability = jStat.normal.cdf(upperZ, 0, 1) - jStat.normal.cdf(lowerZ, 0, 1);
                    probabilityInput.value = roundDisplayValue(probability);

                    updateChartBetween(mean, stddev, lowerX, upperX);
                }
            }
        }

        function updateChartBetween(mean, stddev, lowerX, upperX) {
            const data = [];
            const shadedData = [];
            const minX = mean - 3 * stddev;
            const maxX = mean + 3 * stddev;
            const step = (maxX - minX) / 100;

            for (let i = minX; i <= maxX; i += step) {
                let y = jStat.normal.pdf(i, mean, stddev);
                data.push({ x: i, y: y });
                if (i >= lowerX && i <= upperX) {
                    shadedData.push({ x: i, y: y });
                }
            }

            const isStandardNormal = mean === 0 && stddev === 1;
            const chartLabel = isStandardNormal ? 'Standard Normal Distribution' : `Normal Distribution (μ=${mean}, σ=${stddev})`;
            const xAxisLabel = isStandardNormal ? 'Z' : 'X';

            myChart.data.datasets[0].data = data;
            myChart.data.datasets[0].label = chartLabel;
            myChart.options.scales.x.title.text = xAxisLabel;
            myChart.options.scales.x.min = minX;
            myChart.options.scales.x.max = maxX;
            myChart.data.datasets[1].data = shadedData;
            myChart.update();
        }

        function roundDisplayValue(value) {
            return Math.abs(value) < 1e-6 ? 0 : Math.round(value * 1000000) / 1000000;
        }

        window.onload = function () {
            initializeChart();
            const mean = parseFloat(document.getElementById('mean').value);
            const stddev = parseFloat(document.getElementById('stddev').value);
            if (stddev > 0) {
                updateChart(mean, stddev);
            }
        };
    </script>
</body>
</html>
</template>
  <template id="TPL_T" class="inline-tool">
<!DOCTYPE html>
<html>
<head>
<title>Standard t-Distribution Calculator</title>
<style>
/* existing CSS */
#calculator {
  width: 600px;
  margin: 20px auto;
  border: 1px solid #ccc;
  padding: 20px;
  text-align: center;
}
.input-group {
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.input-group label {
  margin-right: 5px;
  white-space: nowrap;
}
#probability-input {
  margin: 20px 0;
  padding: 10px;
  border: 2px solid #007bff;
  background-color: #e7f3ff;
  font-weight: bold;
  font-size: 16px;
  white-space: nowrap;
}
#distributionChart {
  margin-top: 15px;
}
button {
  display: inline-block;
  margin: 5px;
  padding: 5px 15px;
  font-size: 14px;
  cursor: pointer;
}
button.active {
  background-color: #007bff;
  color: white;
}
#button-container {
  margin-bottom: 20px;
}
input[type="number"] {
  width: 80px;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jstat/1.9.6/jstat.min.js"></script>
</head>
<body>
<div id="calculator">
  <h2>Standard t-Distribution Calculator</h2>
  <div id="button-container">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>
  <div class="input-group"><label for="df">Degrees of Freedom (df):</label><input type="number" id="df" value="1" min="0.001" step="0.001"></div>
  <div id="probability-input">
    <span id="standard-inputs">
      P(t <select id="comparison-operator">
        <option value="less">&le;</option>
        <option value="greater">&ge;</option>
      </select><input type="number" id="x">) = <input type="number" id="probability" step="0.0001">
    </span>
    <span id="between-inputs" style="display: none;">
      P(<input type="number" id="lower-x"> &le; t &le; <input type="number" id="upper-x">) = <input type="number" id="between-probability" step="0.0001">
    </span>
  </div>
  <button onclick="calculate()">Compute</button>
  <canvas id="distributionChart" width="500" height="300"></canvas>
</div>

<script>
let myChart;
let mode = 'standard';

function setMode(selectedMode) {
  mode = selectedMode;
  document.getElementById('standardButton').classList.toggle('active', mode === 'standard');
  document.getElementById('betweenButton').classList.toggle('active', mode === 'between');
  document.getElementById('standard-inputs').style.display = mode === 'standard' ? 'inline' : 'none';
  document.getElementById('between-inputs').style.display = mode === 'between' ? 'inline' : 'none';
  removeShading(); // Remove shading when mode changes
}

function initializeChart() {
  const ctx = document.getElementById('distributionChart').getContext('2d');
  myChart = new Chart(ctx, {
    type: 'scatter',
    data: {
      datasets: [{
        label: 't-Distribution',
        data: [],
        borderColor: 'blue',
        borderWidth: 2,
        fill: false,
        type: 'line',
        pointRadius: 0
      },
      {
        label: 'Shaded Region',
        data: [],
        borderColor: 'rgba(0,0,0,0)',
        backgroundColor: 'rgba(0, 0, 255, 0.3)',
        fill: true,
        type: 'line',
        pointRadius: 0
      }]
    },
    options: {
      scales: {
        x: {
          type: 'linear',
          position: 'bottom',
          min: -5,
          max: 5,
          title: { display: true, text: 't' }
        },
        y: { beginAtZero: true }
      }
    }
  });
}

function updateChart(df, x = null, isLess = true) {
  const data = [];
  const shadedData = [];
  const minX = -5;
  const maxX = 5;
  const step = (maxX - minX) / 100;

  for (let i = minX; i <= maxX; i += step) {
    let y = jStat.studentt.pdf(i, df);
    data.push({ x: i, y: y });
    if (x !== null && ((isLess && i <= x) || (!isLess && i >= x))) {
      shadedData.push({ x: i, y: y });
    }
  }

  myChart.data.datasets[0].data = data;
  myChart.data.datasets[0].label = `t-Distribution (df=${df})`;
  myChart.data.datasets[1].data = shadedData;
  myChart.update();
}

function updateChartBetween(df, lowerX, upperX) {
  const data = [];
  const shadedData = [];
  const minX = -5;
  const maxX = 5;
  const step = (maxX - minX) / 100;

  for (let i = minX; i <= maxX; i += step) {
    let y = jStat.studentt.pdf(i, df);
    data.push({ x: i, y: y });
    if (i >= lowerX && i <= upperX) {
      shadedData.push({ x: i, y: y });
    }
  }

  myChart.data.datasets[0].data = data;
  myChart.data.datasets[0].label = `t-Distribution (df=${df})`;
  myChart.data.datasets[1].data = shadedData;
  myChart.update();
}

function removeShading() {
  if (myChart) {
    myChart.data.datasets[1].data = [];
    myChart.update();
  }
}

document.getElementById('df').addEventListener('input', () => {
  const df = parseFloat(document.getElementById('df').value);
  if (df > 0) {
    updateChart(df);
  }
});

document.getElementById('x').addEventListener('input', () => {
  document.getElementById('probability').value = "";
  removeShading();
});

document.getElementById('probability').addEventListener('input', () => {
  document.getElementById('x').value = "";
  removeShading();
});

document.getElementById('comparison-operator').addEventListener('change', removeShading);

document.getElementById('lower-x').addEventListener('input', () => {
  document.getElementById('between-probability').value = "";
  removeShading();
});

document.getElementById('upper-x').addEventListener('input', () => {
  document.getElementById('between-probability').value = "";
  removeShading();
});

document.getElementById('between-probability').addEventListener('input', () => {
  document.getElementById('lower-x').value = "";
  document.getElementById('upper-x').value = "";
  removeShading();
});

function calculate() {
  const df = parseFloat(document.getElementById('df').value);

  if (df <= 0) { alert("Degrees of freedom must be at least 1."); return; }

  if (mode === 'standard') {
    const xInput = document.getElementById('x');
    const probabilityInput = document.getElementById('probability');
    const comparison = document.getElementById('comparison-operator').value;

    if (!xInput.value && !probabilityInput.value) { alert("Enter t-value or probability."); return; }

    if (xInput.value) {
      const x = parseFloat(xInput.value);
      let probability = comparison === 'less' ? jStat.studentt.cdf(x, df) : 1 - jStat.studentt.cdf(x, df);
      probabilityInput.value = roundDisplayValue(probability);
      updateChart(df, x, comparison === 'less');
    } else {
      let probability = parseFloat(probabilityInput.value);
      if (isNaN(probability) || probability < 0 || probability > 1) { alert("Enter a valid probability (0-1)."); return; }
      let x = comparison === 'less' ? jStat.studentt.inv(probability, df) : jStat.studentt.inv(1 - probability, df);
      xInput.value = roundDisplayValue(x);
      updateChart(df, x, comparison === 'less');
    }
  } else if (mode === 'between') {
    const lowerXInput = document.getElementById('lower-x');
    const upperXInput = document.getElementById('upper-x');
    const probabilityInput = document.getElementById('between-probability');

    if (probabilityInput.value) {
      let probability = parseFloat(probabilityInput.value);
      if (isNaN(probability) || probability <= 0 || probability >= 1) { alert("Enter a valid probability (0-1)."); return; }

      const t = jStat.studentt.inv((1 + probability) / 2, df);
      const lowerX = -t;
      const upperX = t;

      lowerXInput.value = roundDisplayValue(lowerX);
      upperXInput.value = roundDisplayValue(upperX);

      updateChartBetween(df, lowerX, upperX);
    } else {
      if (!lowerXInput.value || !upperXInput.value) { alert("Enter both lower and upper t-values."); return; }

      const lowerX = parseFloat(lowerXInput.value);
      const upperX = parseFloat(upperXInput.value);

      if (lowerX >= upperX) { alert("Upper t must be greater than lower t."); return; }

      let probability = jStat.studentt.cdf(upperX, df) - jStat.studentt.cdf(lowerX, df);
      probabilityInput.value = roundDisplayValue(probability);

      updateChartBetween(df, lowerX, upperX);
    }
  }
}

function roundDisplayValue(value) {
  return Math.abs(value) < 1e-6 ? 0 : Math.round(value * 1000000) / 1000000;
}

// Initialize the chart on page load
window.onload = function() {
  initializeChart();
  const df = parseFloat(document.getElementById('df').value);
  if (df > 0) {
    updateChart(df);
  }
};
document.addEventListener('keypress', function(event) {
  if (event.key === 'Enter') {
    event.preventDefault();
    calculate();
  }
});

</script>
</body>
</html>
</template>
  <template id="TPL_CHISQ" class="inline-tool">
<!DOCTYPE html>
<html>
<head>
<title>Chi-Squared Distribution Calculator</title>
<style>
#calculator {
  width: 600px;
  margin: 20px auto;
  border: 1px solid #ccc;
  padding: 20px;
  text-align: center;
}
.input-group {
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}
.input-group label {
  margin-right: 5px;
  white-space: nowrap;
}
#probability-input {
  margin: 20px 0;
  padding: 10px;
  border: 2px solid #007bff;
  background-color: #e7f3ff;
  font-weight: bold;
  font-size: 16px;
  white-space: nowrap;
}
#distributionChart {
  margin-top: 15px;
}
button {
  display: inline-block;
  margin: 5px;
  padding: 5px 15px;
  font-size: 14px;
  cursor: pointer;
}
button.active {
  background-color: #007bff;
  color: white;
}
#button-container {
  margin-bottom: 20px;
}
input[type="number"] {
  width: 80px;
}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
</head>
<body>
<div id="calculator">
  <h2>Chi-Squared Distribution Calculator</h2>
  <div id="button-container">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>
  <div class="input-group"><label for="df">Degrees of Freedom (df):</label><input type="number" id="df" value="1" min="1" step="1"></div>
  <div id="probability-input">
    <span id="standard-inputs">
      P(χ² <select id="comparison-operator">
        <option value="less">&le;</option>
        <option value="greater">&ge;</option>
      </select><input type="number" id="x">) = <input type="number" id="probability" step="0.0001">
    </span>
    <span id="between-inputs" style="display: none;">
      P(<input type="number" id="lower-x"> &le; χ² &le; <input type="number" id="upper-x">) = <input type="number" id="between-probability" step="0.0001">
    </span>
  </div>
  <button onclick="calculate()">Compute</button>
  <canvas id="distributionChart" width="500" height="300"></canvas>
</div>

<script>
let myChart;
let mode = 'standard';

function setMode(selectedMode) {
  mode = selectedMode;
  document.getElementById('standardButton').classList.toggle('active', mode === 'standard');
  document.getElementById('betweenButton').classList.toggle('active', mode === 'between');
  document.getElementById('standard-inputs').style.display = mode === 'standard' ? 'inline' : 'none';
  document.getElementById('between-inputs').style.display = mode === 'between' ? 'inline' : 'none';
  removeShading(); // Remove shading when mode changes
}

function initializeChart() {
  const ctx = document.getElementById('distributionChart').getContext('2d');
  myChart = new Chart(ctx, {
    type: 'scatter',
    data: {
      datasets: [{
        label: 'Chi-Squared Distribution',
        data: [],
        borderColor: 'blue',
        borderWidth: 2,
        fill: false,
        type: 'line',
        pointRadius: 0
      },
      {
        label: 'Shaded Region',
        data: [],
        borderColor: 'rgba(0,0,0,0)',
        backgroundColor: 'rgba(0, 0, 255, 0.3)',
        fill: true,
        type: 'line',
        pointRadius: 0
      }]
    },
    options: {
      scales: {
        x: {
          type: 'linear',
          position: 'bottom',
          min: 0,
          max: 15,
          title: { display: true, text: 'χ²' }
        },
        y: {
          beginAtZero: true,
          max: 1.6 // Initial max value for df = 1
        }
      }
    }
  });
}

function updateChart(df, x = null, isLess = true) {
  const data = [];
  const shadedData = [];
  const mean = df;
  const threshold = 10; // Adjust this threshold to see more of the curve
  const minX = 0;
  const maxX = mean + threshold;

  const step = (maxX - minX) / 100;

  for (let i = minX; i <= maxX; i += step) {
    let y = jStat.chisquare.pdf(i, df);
    data.push({ x: i, y: y });
    if (x !== null && ((isLess && i <= x) || (!isLess && i >= x))) {
      shadedData.push({ x: i, y: y });
    }
  }

  myChart.options.scales.x.min = minX;
  myChart.options.scales.x.max = maxX;
  myChart.options.scales.y.max = df === 1 ? 1.6 : (df === 2 ? 0.5 : (df === 3 ? 0.25 : 0.2));
  myChart.data.datasets[0].data = data;
  myChart.data.datasets[0].label = `Chi-Squared Distribution (df=${df})`;
  myChart.data.datasets[1].data = shadedData;
  myChart.update();
}

function updateChartBetween(df, lowerX, upperX) {
  const data = [];
  const shadedData = [];
  const mean = df;
  const threshold = 5; // Adjust this threshold to see more of the curve
  const minX = 0;
  const maxX = mean + threshold;

  const step = (maxX - minX) / 100;

  for (let i = minX; i <= maxX; i += step) {
    let y = jStat.chisquare.pdf(i, df);
    data.push({ x: i, y: y });
    if (i >= lowerX && i <= upperX) {
      shadedData.push({ x: i, y: y });
    }
  }

  myChart.options.scales.x.min = minX;
  myChart.options.scales.x.max = maxX;
  myChart.options.scales.y.max = df === 1 ? 1.6 : (df === 2 ? 0.5 : (df === 3 ? 0.25 : 0.2));
  myChart.data.datasets[0].data = data;
  myChart.data.datasets[0].label = `Chi-Squared Distribution (df=${df})`;
  myChart.data.datasets[1].data = shadedData;
  myChart.update();
}

function removeShading() {
  if (myChart) {
    myChart.data.datasets[1].data = [];
    myChart.update();
  }
}

document.getElementById('df').addEventListener('input', () => {
  const df = parseInt(document.getElementById('df').value);
  if (df >= 1) {
    updateChart(df);
  }
});

document.getElementById('x').addEventListener('input', () => {
  document.getElementById('probability').value = "";
  removeShading();
});

document.getElementById('probability').addEventListener('input', () => {
  document.getElementById('x').value = "";
  removeShading();
});

document.getElementById('comparison-operator').addEventListener('change', removeShading);

document.getElementById('lower-x').addEventListener('input', () => {
  document.getElementById('between-probability').value = "";
  removeShading();
});

document.getElementById('upper-x').addEventListener('input', () => {
  document.getElementById('between-probability').value = "";
  removeShading();
});

document.getElementById('between-probability').addEventListener('input', () => {
  document.getElementById('lower-x').value = "";
  document.getElementById('upper-x').value = "";
  removeShading();
});

function calculate() {
  const df = parseInt(document.getElementById('df').value);

  if (df < 1) { alert("Degrees of freedom must be at least 1."); return; }

  if (mode === 'standard') {
    const xInput = document.getElementById('x');
    const probabilityInput = document.getElementById('probability');
    const comparison = document.getElementById('comparison-operator').value;

    if (!xInput.value && !probabilityInput.value) { alert("Enter χ²-value or probability."); return; }

    if (xInput.value) {
      const x = parseFloat(xInput.value);
      let probability = comparison === 'less' ? jStat.chisquare.cdf(x, df) : 1 - jStat.chisquare.cdf(x, df);
      probabilityInput.value = roundDisplayValue(probability);
      updateChart(df, x, comparison === 'less');
    } else {
      let probability = parseFloat(probabilityInput.value);
      if (isNaN(probability) || probability < 0 || probability > 1) { alert("Enter a valid probability (0-1)."); return; }
      let x = comparison === 'less' ? jStat.chisquare.inv(probability, df) : jStat.chisquare.inv(1 - probability, df);
      xInput.value = roundDisplayValue(x);
      updateChart(df, x, comparison === 'less');
    }
  } else if (mode === 'between') {
    const lowerXInput = document.getElementById('lower-x');
    const upperXInput = document.getElementById('upper-x');
    const probabilityInput = document.getElementById('between-probability');

    if (probabilityInput.value) {
      let probability = parseFloat(probabilityInput.value);
      if (isNaN(probability) || probability <= 0 || probability >= 1) { alert("Enter a valid probability (0-1)."); return; }

      const lowerX = jStat.chisquare.inv((1 - probability) / 2, df);
      const upperX = jStat.chisquare.inv((1 + probability) / 2, df);

      lowerXInput.value = roundDisplayValue(lowerX);
      upperXInput.value = roundDisplayValue(upperX);

      updateChartBetween(df, lowerX, upperX);
    } else {
      if (!lowerXInput.value || !upperXInput.value) { alert("Enter both lower and upper χ²-values."); return; }

      const lowerX = parseFloat(lowerXInput.value);
      const upperX = parseFloat(upperXInput.value);

      if (lowerX >= upperX) { alert("Upper χ² must be greater than lower χ²."); return; }

      let probability = jStat.chisquare.cdf(upperX, df) - jStat.chisquare.cdf(lowerX, df);
      probabilityInput.value = roundDisplayValue(probability);

      updateChartBetween(df, lowerX, upperX);
    }
  }
}

function roundDisplayValue(value) {
  return Math.abs(value) < 1e-6 ? 0 : Math.round(value * 1000000) / 1000000;
}

// Initialize the chart on page load
window.onload = function() {
  initializeChart();
  updateChart(1); // Initialize with df = 1
};
</script>

</body>
</html>
</template>
  <template id="TPL_F" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>F Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>F Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="df1">Numerator DF (d₁):</label>
    <input type="number" id="df1" value="5" min="1" step="1">
    <label for="df2">Denominator DF (d₂):</label>
    <input type="number" id="df2" value="10" min="1" step="1">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const df1 = parseInt(document.getElementById('df1').value);
      const df2 = parseInt(document.getElementById('df2').value);
      if (isNaN(df1) || isNaN(df2) || df1 < 1 || df2 < 1) {
        alert('Please enter valid degrees of freedom (≥ 1).');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.centralF.cdf(x, df1, df2) : 1 - jStat.centralF.cdf(x, df1, df2);
          pInput.value = prob.toFixed(6);
          drawChart(df1, df2, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.centralF.inv(p, df1, df2) : jStat.centralF.inv(1 - p, df1, df2);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(df1, df2, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.centralF.cdf(upperX, df1, df2) - jStat.centralF.cdf(lowerX, df1, df2);
          betweenP.value = p.toFixed(6);
          drawChart(df1, df2, lowerX, upperX);
        }
      }
    }

    function drawChart(df1, df2, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.1;
      const maxX = jStat.centralF.inv(0.995, df1, df2);
      const data = [];
      const shaded = [];
      for (let x = 0.01; x <= maxX; x += step) {
        let y = jStat.centralF.pdf(x, df1, df2);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `F(d₁=${df1}, d₂=${df2})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
      setMode('standard');
      const df1 = parseInt(document.getElementById('df1').value);
      const df2 = parseInt(document.getElementById('df2').value);
      if (!isNaN(df1) && !isNaN(df2) && df1 > 0 && df2 > 0) {
        drawChart(df1, df2);
      }
    });
  </script>
</body>
</html>

</template>

  <template id="TPL_BETA" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beta Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Beta Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="alpha">α:</label>
    <input type="number" id="alpha" value="2" step="0.01" min="0.01">
    <label for="beta">β:</label>
    <input type="number" id="beta" value="2" step="0.01" min="0.01">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
    }

    function calculate() {
      const alpha = parseFloat(document.getElementById('alpha').value);
      const beta = parseFloat(document.getElementById('beta').value);
      if (alpha <= 0 || beta <= 0) {
        alert('α and β must be > 0');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.beta.cdf(x, alpha, beta) : 1 - jStat.beta.cdf(x, alpha, beta);
          pInput.value = prob.toFixed(6);
          drawChart(alpha, beta, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.beta.inv(p, alpha, beta) : jStat.beta.inv(1 - p, alpha, beta);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(alpha, beta, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.beta.cdf(upperX, alpha, beta) - jStat.beta.cdf(lowerX, alpha, beta);
          betweenP.value = p.toFixed(6);
          drawChart(alpha, beta, lowerX, upperX);
        } else if (!isNaN(parseFloat(betweenP.value))) {
  const targetP = parseFloat(betweenP.value);
  const mid = jStat.beta.mean(alpha, beta);
  let lowerGuess = mid - 0.1;
  let upperGuess = mid + 0.1;
  lowerGuess = Math.max(0, lowerGuess);
  upperGuess = Math.min(1, upperGuess);
  let found = false;
  for (let delta = 0.05; delta < 0.5; delta += 0.001) {
    const l = Math.max(0, mid - delta);
    const u = Math.min(1, mid + delta);
    const prob = jStat.beta.cdf(u, alpha, beta) - jStat.beta.cdf(l, alpha, beta);
    if (Math.abs(prob - targetP) < 0.0001) {
      document.getElementById('lower-x').value = l.toFixed(6);
      document.getElementById('upper-x').value = u.toFixed(6);
      drawChart(alpha, beta, l, u);
      found = true;
      break;
    }
  }
  if (!found) {
    alert("Could not estimate interval for given probability.");
  }
}
      }
    }

    function drawChart(alpha, beta, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.01;
      const data = [];
      const shaded = [];
      for (let x = 0; x <= 1; x += step) {
        let y = jStat.beta.pdf(x, alpha, beta);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
        (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Beta(α=${alpha}, β=${beta})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', min: 0, max: 1, title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
  setMode('standard');
  const alpha = parseFloat(document.getElementById('alpha').value);
  const beta = parseFloat(document.getElementById('beta').value);
  drawChart(alpha, beta);
});
  </script>
</body>
</html>

</template>
  <template id="TPL_GAMMA" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gamma Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Gamma Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="alpha">Shape (α):</label>
    <input type="number" id="alpha" value="2" min="0.1" step="0.1">
    <label for="beta">Rate (β):</label>
    <input type="number" id="beta" value="1" min="0.01" step="0.01">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const alpha = parseFloat(document.getElementById('alpha').value);
      const beta = parseFloat(document.getElementById('beta').value);
      if (alpha <= 0 || beta <= 0) {
        alert('Alpha and Beta must be > 0');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.gamma.cdf(x, alpha, 1 / beta) : 1 - jStat.gamma.cdf(x, alpha, 1 / beta);
          pInput.value = prob.toFixed(6);
          drawChart(alpha, beta, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.gamma.inv(p, alpha, 1 / beta) : jStat.gamma.inv(1 - p, alpha, 1 / beta);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(alpha, beta, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.gamma.cdf(upperX, alpha, 1 / beta) - jStat.gamma.cdf(lowerX, alpha, 1 / beta);
          betweenP.value = p.toFixed(6);
          drawChart(alpha, beta, lowerX, upperX);
        }
      }
    }

    function drawChart(alpha, beta, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.1;
      const maxX = jStat.gamma.inv(0.995, alpha, 1 / beta);
      const data = [];
      const shaded = [];
      for (let x = 0; x <= maxX; x += step) {
        let y = jStat.gamma.pdf(x, alpha, 1 / beta);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Gamma(α=${alpha}, β=${beta})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
      setMode('standard');
      const alpha = parseFloat(document.getElementById('alpha').value);
      const beta = parseFloat(document.getElementById('beta').value);
      if (!isNaN(alpha) && !isNaN(beta) && alpha > 0 && beta > 0) {
        drawChart(alpha, beta);
      }
    });
  </script>
</body>
</html>

</template>
  <template id="TPL_EXP" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Exponential Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Exponential Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="mean">Mean (μ):</label>
    <input type="number" id="mean" value="1" step="0.01" min="0.01">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const mean = parseFloat(document.getElementById('mean').value);
      if (isNaN(mean) || mean <= 0) {
        alert('Mean must be a positive number.');
        return;
      }
      const lambda = 1 / mean;

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.exponential.cdf(x, lambda) : 1 - jStat.exponential.cdf(x, lambda);
          pInput.value = prob.toFixed(6);
          drawChart(lambda, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.exponential.inv(p, lambda) : jStat.exponential.inv(1 - p, lambda);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(lambda, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.exponential.cdf(upperX, lambda) - jStat.exponential.cdf(lowerX, lambda);
          betweenP.value = p.toFixed(6);
          drawChart(lambda, lowerX, upperX);
        }
      }
    }

    function drawChart(lambda, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.1;
      const maxX = 10 / lambda;
      const data = [];
      const shaded = [];
      for (let x = 0; x <= maxX; x += step) {
        let y = jStat.exponential.pdf(x, lambda);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Exponential(mean = ${1 / lambda})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
      setMode('standard');
      const mean = parseFloat(document.getElementById('mean').value);
      if (!isNaN(mean) && mean > 0) {
        drawChart(1 / mean);
      }
    });
  </script>
</body>
</html>

</template>
  <template id="TPL_WEIBULL" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weibull Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Weibull Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="alpha">Shape (α):</label>
    <input type="number" id="alpha" value="2" step="0.01" min="0.01">
    <label for="beta">Scale (β):</label>
    <input type="number" id="beta" value="2" step="0.01" min="0.01">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const alpha = parseFloat(document.getElementById('alpha').value);
      const beta = parseFloat(document.getElementById('beta').value);
      if (isNaN(alpha) || isNaN(beta) || alpha <= 0 || beta <= 0) {
        alert('Both α and β must be > 0');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.weibull.cdf(x, alpha, beta) : 1 - jStat.weibull.cdf(x, alpha, beta);
          pInput.value = prob.toFixed(6);
          drawChart(alpha, beta, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.weibull.inv(p, alpha, beta) : jStat.weibull.inv(1 - p, alpha, beta);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(alpha, beta, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.weibull.cdf(upperX, alpha, beta) - jStat.weibull.cdf(lowerX, alpha, beta);
          betweenP.value = p.toFixed(6);
          drawChart(alpha, beta, lowerX, upperX);
        }
      }
    }

    function drawChart(alpha, beta, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.1;
      const maxX = jStat.weibull.inv(0.995, alpha, beta);
      const data = [];
      const shaded = [];
      for (let x = 0; x <= maxX; x += step) {
        let y = jStat.weibull.pdf(x, alpha, beta);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Weibull(α=${alpha}, β=${beta})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
      setMode('standard');
      const alpha = parseFloat(document.getElementById('alpha').value);
      const beta = parseFloat(document.getElementById('beta').value);
      if (!isNaN(alpha) && !isNaN(beta) && alpha > 0 && beta > 0) {
        drawChart(alpha, beta);
      }
    });
  </script>
</body>
</html>

</template>
  <template id="TPL_LOGNORMAL" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lognormal Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Lognormal Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="location">Location (μ):</label>
    <input type="number" id="location" value="0" step="0.01">
    <label for="scale">Scale (σ):</label>
    <input type="number" id="scale" value="1" step="0.01" min="0.01">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const mu = parseFloat(document.getElementById('location').value);
      const sigma = parseFloat(document.getElementById('scale').value);
      if (isNaN(mu) || isNaN(sigma) || sigma <= 0) {
        alert('Please enter valid parameters: σ > 0.');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.lognormal.cdf(x, mu, sigma) : 1 - jStat.lognormal.cdf(x, mu, sigma);
          pInput.value = prob.toFixed(6);
          drawChart(mu, sigma, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.lognormal.inv(p, mu, sigma) : jStat.lognormal.inv(1 - p, mu, sigma);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(mu, sigma, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.lognormal.cdf(upperX, mu, sigma) - jStat.lognormal.cdf(lowerX, mu, sigma);
          betweenP.value = p.toFixed(6);
          drawChart(mu, sigma, lowerX, upperX);
        }
      }
    }

    function drawChart(mu, sigma, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.1;
      const maxX = jStat.lognormal.inv(0.995, mu, sigma);
      const data = [];
      const shaded = [];
      for (let x = 0.01; x <= maxX; x += step) {
        let y = jStat.lognormal.pdf(x, mu, sigma);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Lognormal(μ=${mu}, σ=${sigma})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
      setMode('standard');
      const mu = parseFloat(document.getElementById('location').value);
      const sigma = parseFloat(document.getElementById('scale').value);
      if (!isNaN(mu) && !isNaN(sigma) && sigma > 0) {
        drawChart(mu, sigma);
      }
    });
  </script>
</body>
</html>

</template>
  <template id="TPL_CAUCHY" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cauchy Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Cauchy Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

    <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const x0 = 0;
      const gamma = 1;
      if (gamma <= 0) {
        alert('Scale parameter γ must be > 0');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.cauchy.cdf(x, x0, gamma) : 1 - jStat.cauchy.cdf(x, x0, gamma);
          pInput.value = prob.toFixed(6);
          drawChart(0, 1, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.cauchy.inv(p, x0, gamma) : jStat.cauchy.inv(1 - p, x0, gamma);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(x0, gamma, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.cauchy.cdf(upperX, x0, gamma) - jStat.cauchy.cdf(lowerX, x0, gamma);
          betweenP.value = p.toFixed(6);
          drawChart(x0, gamma, lowerX, upperX);
        }
      }
    }

    function drawChart(x0 = 0, gamma = 1, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.1;
      const minX = x0 - 10 * gamma;
      const maxX = x0 + 10 * gamma;
      const data = [];
      const shaded = [];
      for (let x = minX; x <= maxX; x += step) {
        let y = jStat.cauchy.pdf(x, x0, gamma);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Cauchy(x₀=${x0}, γ=${gamma})`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0.2
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
  setMode('standard');
  drawChart(0, 1);
});
  </script>
</body>
</html>

</template>
  <template id="TPL_UNIFORM" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Uniform Distribution Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      background-color: white;
    }
    h2 {
      text-align: center;
    }
    .input-group {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
    }
    label {
      white-space: nowrap;
    }
    input {
      width: 80px;
      padding: 5px;
    }
    .button-group {
      text-align: center;
      margin-bottom: 20px;
    }
    .button-group button {
      margin: 0 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
    #distributionChart {
      max-width: 600px;
      margin: 20px auto;
    }
  </style>
</head>
<body>
  <h2>Uniform Distribution Calculator</h2>
  <div class="button-group">
    <button id="standardButton" class="active" onclick="setMode('standard')">Standard</button>
    <button id="betweenButton" onclick="setMode('between')">Between</button>
  </div>

  <div class="input-group">
    <label for="a">Lower (a):</label>
    <input type="number" id="a" value="0" step="0.01">
    <label for="b">Upper (b):</label>
    <input type="number" id="b" value="1" step="0.01">
  </div>

  <div id="standard-inputs" class="input-group">
    <label>P(X
      <select id="comparison">
        <option value="less">≤</option>
        <option value="greater">≥</option>
      </select>
    </label>
    <input type="number" id="x" step="0.0001">
    =
    <input type="number" id="probability" step="0.0001">
  </div>

  <div id="between-inputs" class="input-group" style="display:none">
    <label>P(</label>
    <input type="number" id="lower-x" step="0.0001">
    ≤ X ≤
    <input type="number" id="upper-x" step="0.0001">
    =
    <input type="number" id="between-probability" step="0.0001">
  </div>

  <div style="text-align:center">
    <button onclick="calculate()">Compute</button>
  </div>

  <canvas id="distributionChart" width="600" height="300"></canvas>

  <script>
    let mode = 'standard';
    let chart;

    function setMode(selected) {
      mode = selected;
      document.getElementById('standard-inputs').style.display = (selected === 'standard') ? 'flex' : 'none';
      document.getElementById('between-inputs').style.display = (selected === 'between') ? 'flex' : 'none';
      document.getElementById('standardButton').classList.toggle('active', selected === 'standard');
      document.getElementById('betweenButton').classList.toggle('active', selected === 'between');
    }

    function calculate() {
      const a = parseFloat(document.getElementById('a').value);
      const b = parseFloat(document.getElementById('b').value);
      if (isNaN(a) || isNaN(b) || a >= b) {
        alert('Please enter valid numbers: a < b');
        return;
      }

      const x = parseFloat(document.getElementById('x').value);
      const pInput = document.getElementById('probability');
      const comparison = document.getElementById('comparison').value;
      const lowerX = parseFloat(document.getElementById('lower-x').value);
      const upperX = parseFloat(document.getElementById('upper-x').value);
      const betweenP = document.getElementById('between-probability');

      if (mode === 'standard') {
        if (!isNaN(x)) {
          let prob = comparison === 'less' ? jStat.uniform.cdf(x, a, b) : 1 - jStat.uniform.cdf(x, a, b);
          pInput.value = prob.toFixed(6);
          drawChart(a, b, comparison === 'less' ? x : null, comparison === 'greater' ? x : null);
        } else if (!isNaN(parseFloat(pInput.value))) {
          let p = parseFloat(pInput.value);
          let val = comparison === 'less' ? jStat.uniform.inv(p, a, b) : jStat.uniform.inv(1 - p, a, b);
          document.getElementById('x').value = val.toFixed(6);
          drawChart(a, b, comparison === 'less' ? val : null, comparison === 'greater' ? val : null);
        }
      } else {
        if (!isNaN(lowerX) && !isNaN(upperX)) {
          let p = jStat.uniform.cdf(upperX, a, b) - jStat.uniform.cdf(lowerX, a, b);
          betweenP.value = p.toFixed(6);
          drawChart(a, b, lowerX, upperX);
        }
      }
    }

    function drawChart(a = 0, b = 1, lower = null, upper = null) {
      const ctx = document.getElementById('distributionChart').getContext('2d');
      const step = 0.01;
      const data = [];
      const shaded = [];
      for (let x = a - 0.5; x <= b + 0.5; x += step) {
        let y = jStat.uniform.pdf(x, a, b);
        data.push({x, y});
        if ((lower !== null && x <= lower && upper === null) ||
            (upper !== null && x >= upper && lower === null) ||
            (lower !== null && upper !== null && x >= lower && x <= upper)) {
          shaded.push({x, y});
        }
      }

      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          datasets: [
            {
              label: `Uniform(0, 1)`,
              data: data,
              borderColor: 'blue',
              fill: false,
              pointRadius: 0,
              tension: 0
            },
            {
              label: 'Shaded Region',
              data: shaded,
              backgroundColor: 'rgba(0, 0, 255, 0.3)',
              borderColor: 'rgba(0,0,0,0)',
              fill: true,
              pointRadius: 0,
              type: 'line'
            }
          ]
        },
        options: {
          scales: {
            x: { type: 'linear', title: { display: true, text: 'X' } },
            y: { beginAtZero: true }
          }
        }
      });
    }

    window.addEventListener('DOMContentLoaded', () => {
  setMode('standard');
  const a = parseFloat(document.getElementById('a').value);
  const b = parseFloat(document.getElementById('b').value);
  drawChart(a, b, null, null);
});
  </script>
</body>
</html>

</template>

  <template id="TPL_POISSON" class="inline-tool">__INLINE_POISSON__</template>
  <template id="TPL_GEOMETRIC" class="inline-tool">__INLINE_GEOMETRIC__</template>
  <template id="TPL_HYPERGEO" class="inline-tool">__INLINE_HYPERGEO__</template>

  <template id="TPL_CI" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Confidence Interval Calculator</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6">
</script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    .button-group button.active {
      background-color: #4285f4;
      color: white;
      border: 1px solid #3367d6;
    }
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      padding: 40px;
    }
    .container {
      border: 2px solid #ccc;
      border-radius: 12px;
      padding: 30px;
      max-width: 700px;
      width: 100%;
      background-color: #fafafa;
      text-align: center;
    }
    .button-group button {
      margin-right: 10px;
      margin-bottom: 10px;
    }
    .input-group {
      margin-bottom: 10px;
      text-align: left;
    }
    label {
      display: inline-block;
      width: 250px;
    }
    select#knowPopSD {
      font-size: 0.9em;
      width: auto;
    }
    label[for="knowPopSD"] {
      font-size: 0.9em;
    }
    input, select {
      padding: 4px;
    }
    .result-box {
      background-color: #f4f4f4;
      padding: 15px;
      margin-top: 20px;
      border-radius: 6px;
      text-align: center;
    }
    .bold-interval {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    .formula-text {
      margin-top: 10px;
    }
    .error {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Confidence Interval Calculator</h2>

    <div class="button-group" style="display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 10px;">
  <button onclick="selectType('proportion')" data-type="proportion" style="height: 45px;">Proportion</button>
  <button onclick="selectType('mean')" data-type="mean" style="height: 45px;">Mean</button>
  <div style="display: flex; flex-direction: column; align-items: center;">
    <button onclick="selectType('difference')" data-type="difference" style="width: 250px; margin-bottom: 5px;">Difference Between Two Means</button>
    <button onclick="selectType('diffprop')" data-type="diffprop" style="width: 250px;">Difference Between Two Proportions</button>
  </div>
  <button onclick="selectType('stddev')" data-type="stddev" style="height: 45px;">Standard Deviation</button>
</div>

    <div id="inputSection" class="section"></div>
    <div id="result" class="section"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <script>
    let currentType = "";

    function createLabeledInput(id, labelText, type = "number", step = "any") {
      return `<div class="input-group">
                <label for="${id}">${labelText}</label>
                <input id="${id}" name="${id}" type="${type}" step="${step}" />
              </div>`;
    }

    function selectType(type) {
      const buttons = document.querySelectorAll('.button-group button');
      buttons.forEach(btn => btn.classList.remove('active'));
      const allButtons = document.querySelectorAll('.button-group button');
      allButtons.forEach(btn => btn.classList.remove('active'));
      const clickedButton = Array.from(buttons).find(btn => btn.dataset.type === type);
      if (clickedButton) clickedButton.classList.add('active');
      currentType = type;
      let html = '';
      if (type === 'proportion') {
        html = createLabeledInput("successes", "Number of Successes:") +
               createLabeledInput("total", "Total Sample Size:") +
               createLabeledInput("confLevel", "Confidence Level (%):");

      } else if (type === 'mean') {
        html = createLabeledInput("mean", "Sample Mean:") +
               createLabeledInput("size", "Sample Size (n):") +
               `<div class="input-group">
                  <label for="knowPopSD">Do you know the population SD?</label>
                  <select id="knowPopSD" onchange="toggleSDInput()">
                    <option value="no">No</option>
                    <option value="yes">Yes</option>
                  </select>
                </div>` +
               `<div id="sdInputs">
                  ${createLabeledInput("sampleSD", "Sample SD (s):")}
                </div>` +
               createLabeledInput("confLevel", "Confidence Level (%):");

      } else if (type === 'difference') {
        html = createLabeledInput("mean1", "Mean 1 (x̄₁):") +
               createLabeledInput("sd1", "SD 1 (s₁):") +
               createLabeledInput("n1", "Size 1 (n₁):") +
               createLabeledInput("mean2", "Mean 2 (x̄₂):") +
               createLabeledInput("sd2", "SD 2 (s₂):") +
               createLabeledInput("n2", "Size 2 (n₂):") +
               `<div class="input-group" style="display: flex; align-items: center; gap: 10px;">
  <label style="width: auto;">Degrees of Freedom Method:</label>
  <label style="margin: 0;"><input type="radio" name="dfOption" value="unequal" checked> Unequal Variances (recommended)</label>
  <label style="margin: 0;"><input type="radio" name="dfOption" value="equal"> Equal Variances (pooled)</label>
  <label style="margin: 0;"><input type="radio" name="dfOption" value="simplified"> Simplified (min)</label>
</div>` +
               createLabeledInput("confLevel", "Confidence Level (%):");

      } else if (type === 'stddev') {
        html = createLabeledInput("sampleSD", "Sample SD (s):") +
               createLabeledInput("size", "Sample Size (n):") +
               createLabeledInput("confLevel", "Confidence Level (%):");
      } else if (type === 'diffprop') {
  html = createLabeledInput("x1", "Sample 1 Successes (x₁):") +
         createLabeledInput("n1", "Sample 1 Size (n₁):") +
         createLabeledInput("x2", "Sample 2 Successes (x₂):") +
         createLabeledInput("n2", "Sample 2 Size (n₂):") +
         createLabeledInput("confLevel", "Confidence Level (%):");
}
      
      html += `<button onclick="calculate()">Calculate</button>`;
      document.getElementById("inputSection").innerHTML = html;
      document.getElementById("result").innerHTML = "";

      // New: clear results when any input/select changes
      document.querySelectorAll('#inputSection input, #inputSection select').forEach(el => {
        el.addEventListener('input', () => {
          document.getElementById('result').innerHTML = '';
        });
      });
    }

    function toggleSDInput() {
      const knowPop = document.getElementById("knowPopSD").value;
      const sdInputs = document.getElementById("sdInputs");
      if (knowPop === "yes") {
        sdInputs.innerHTML = createLabeledInput("popSD", "Population SD (σ):");
      } else {
        sdInputs.innerHTML = createLabeledInput("sampleSD", "Sample SD (s):");
      }
    }

    function calculate() {
      function getValue(id) {
        const el = document.getElementById(id);
        if (!el || el.value.trim() === '') {
          alert(`Please enter a value for ${id.replace(/([A-Z])/g, ' $1')}`);
          throw new Error(`Missing value: ${id}`);
        }
        return parseFloat(el.value);
      }
      const confLevel = getValue("confLevel");
      if (!isNaN(confLevel) && confLevel <= 1) {
        alert("Confidence level should be greater than 1 and entered as a percentage. i.e. 95% confidence should be entered as 95");
        return;
      }
      if (confLevel <= 0 || confLevel >= 100) {
        alert("Confidence level must be between 0 and 100.");
        return;
      }
      const alpha = 1 - confLevel / 100;
      const z = jStat.normal.inv(1 - alpha / 2, 0, 1);
      let resultHTML = '';

      function renderMath(formulaLatex, numericLatex, intervalText) {
        const toggleHTML = `<div style='text-align:left; font-size: 0.85em;'><a href='#' onclick='toggleFormula(event)' id='toggle-link'>Show/Hide Formula</a></div>`;
        const formulaContent = `<div id='formula-box' style='display:none;'>
          <div class='formula-text'>
            <div>$$${formulaLatex}$$</div>
            <div>$$${numericLatex}$$</div>
          </div>
        </div>`;
        return `
          ${toggleHTML}
          <div class=\"result-box\">
          ${formulaContent}
          <div class=\"bold-interval\">${intervalText}</div>
          </div>
        `;
      }

      if (currentType === 'proportion') {
        const successes = getValue("successes");
        const total = getValue("total");
        if (isNaN(successes) || isNaN(total) || total <= 0 || successes > total) {
          resultHTML = '<p class="error">Enter valid numbers: 0 ≤ Successes ≤ Total</p>';
        } else {
          const phat = successes / total;
          const se = Math.sqrt(phat * (1 - phat) / total);
          const margin = z * se;
          const lower = (phat - margin).toFixed(4);
          const upper = (phat + margin).toFixed(4);

          const formula = "\\hat{p} \\pm z^* \\sqrt{\\frac{\\hat{p}(1 - \\hat{p})}{n}}";
          const numeric = `${phat.toFixed(4)} \\pm ${z.toFixed(4)} \\times ${se.toFixed(4)}`;


          resultHTML = renderMath(formula, numeric, `Confidence Interval: (${lower}, ${upper})`);
        }
      } else if (currentType === 'mean') {
        const mean = getValue("mean");
        const n = getValue("size");
        if (n <= 0) {
          resultHTML = '<p class="error">Sample size must be positive.</p>';
        } else {
          const knowPop = document.getElementById("knowPopSD").value;
          let se, statVal, formula, numeric;
          if (knowPop === "yes") {
            const sigma = getValue("popSD");
            if (sigma <= 0) {
              resultHTML = '<p class="error">Population SD must be positive.</p>';
            } else {
              se = sigma / Math.sqrt(n);
              statVal = z;
              formula = "\\bar{x} \\pm z^* \\frac{\\sigma}{\\sqrt{n}}";
              numeric = `${mean.toFixed(4)} \\pm ${z.toFixed(4)} \\times ${se.toFixed(4)}`;
            }
          } else {
            const s = getValue("sampleSD");
            if (s <= 0) {
              resultHTML = '<p class="error">Sample SD must be positive.</p>';
            } else {
              se = s / Math.sqrt(n);
              const t = jStat.studentt.inv(1 - alpha / 2, n - 1);
              statVal = t;
              formula = `\\bar{x} \\pm t^*_{${n - 1}} \\frac{s}{\\sqrt{n}}`;
              numeric = `${mean.toFixed(4)} \\pm ${t.toFixed(4)} \\times ${se.toFixed(4)}`;
            }
          }
          if (se && statVal) {
            const margin = statVal * se;
            const lower = (mean - margin).toFixed(4);
            const upper = (mean + margin).toFixed(4);
            resultHTML = renderMath(formula, numeric, `Confidence Interval: (${lower}, ${upper})`);
          }
        }
      } else if (currentType === 'difference') {
        const m1 = getValue("mean1");
        const s1 = getValue("sd1");
        const n1 = getValue("n1");
        const m2 = getValue("mean2");
        const s2 = getValue("sd2");
        const n2 = getValue("n2");
        if ([n1, n2].some(n => n <= 0) || [s1, s2].some(s => s <= 0)) {
          resultHTML = '<p class="error">All sample sizes and SDs must be positive.</p>';
        } else {
          const diff = m1 - m2;
          const se = Math.sqrt(s1 ** 2 / n1 + s2 ** 2 / n2);
          const dfOption = document.querySelector('input[name="dfOption"]:checked').value;
          let df;
          if (dfOption === 'unequal') {
            const num = Math.pow((s1 ** 2 / n1 + s2 ** 2 / n2), 2);
            const denom = (Math.pow(s1 ** 2 / n1, 2) / (n1 - 1)) + (Math.pow(s2 ** 2 / n2, 2) / (n2 - 1));
            df = num / denom;
          } else if (dfOption === 'equal') {
            df = n1 + n2 - 2;
          } else {
            df = Math.min(n1 - 1, n2 - 1);
          }
          const t = jStat.studentt.inv(1 - alpha / 2, df);
          const margin = t * se;
          const lower = (diff - margin).toFixed(4);
          const upper = (diff + margin).toFixed(4);
          const formula = `(\\bar{x}_1 - \\bar{x}_2) \\pm t^*_{${df.toFixed(2)}} \\sqrt{\\frac{s_1^2}{n_1} + \\frac{s_2^2}{n_2}} \\quad (df = ${df.toFixed(2)})`;
          const numeric = `${diff.toFixed(4)} \\pm ${t.toFixed(4)} \\times ${se.toFixed(4)}`;

          resultHTML = renderMath(formula, numeric, `Confidence Interval: (${lower}, ${upper})`);
        }
      }
    else if (currentType === 'diffprop') {
          const x1 = getValue("x1");
          const n1 = getValue("n1");
          const x2 = getValue("x2");
          const n2 = getValue("n2");
          if ([x1, x2].some(x => x < 0) || [n1, n2].some(n => n <= 0) || x1 > n1 || x2 > n2) {
            resultHTML = '<p class="error">Enter valid success counts and sample sizes.</p>';
          } else {
            const p1 = x1 / n1;
            const p2 = x2 / n2;
            const diff = p1 - p2;
            const se = Math.sqrt((p1 * (1 - p1)) / n1 + (p2 * (1 - p2)) / n2);
            const margin = z * se;
            const lower = (diff - margin).toFixed(4);
            const upper = (diff + margin).toFixed(4);
            const formula = `(\\hat{p}_1 - \\hat{p}_2) \\pm z^* \\sqrt{\\frac{\\hat{p}_1(1 - \\hat{p}_1)}{n_1} + \\frac{\\hat{p}_2(1 - \\hat{p}_2)}{n_2}}`;
            const numeric = `${diff.toFixed(4)} \\pm ${z.toFixed(4)} \\times ${se.toFixed(4)}`;
            resultHTML = renderMath(formula, numeric, `Confidence Interval: (${lower}, ${upper})`);
          }
        

      } else if (currentType === 'stddev') {
        const s = getValue("sampleSD");
        const n = getValue("size");
        if (s <= 0 || n <= 1) {
          resultHTML = '<p class="error">Sample SD must be positive and n > 1.</p>';
        } else {
          const df = n - 1;
          const chi2Lower = jStat.chisquare.inv(1 - alpha / 2, df);
          const chi2Upper = jStat.chisquare.inv(alpha / 2, df);
          const lower = Math.sqrt((df * s * s) / chi2Lower).toFixed(4);
          const upper = Math.sqrt((df * s * s) / chi2Upper).toFixed(4);
          const formula = `\\sqrt{\\frac{(n - 1)s^2}{\\chi^2_{n-1, α/2}}} < \\sigma < \\sqrt{\\frac{(n - 1)s^2}{\\chi^2_{n-1, 1- α/2}}}`;

          const numeric = `\\sqrt{\\frac{(${df})(${s.toFixed(4)})^2}{${chi2Upper.toFixed(4)}}} < \\sigma < \\sqrt{\\frac{(${df})(${s.toFixed(4)})^2}{${chi2Lower.toFixed(4)}}}`;

          resultHTML = renderMath(formula, numeric, `Confidence Interval: (${lower}, ${upper})`);
        }
      }

      document.getElementById("result").innerHTML = resultHTML;
      if (window.MathJax) MathJax.typesetPromise();
      if (window.MathJax) MathJax.typesetPromise();
    }
  
    function toggleFormula(event) {
    event.preventDefault();
    const formulaBox = document.getElementById("formula-box");
    if (formulaBox.style.display === "none") {
      formulaBox.style.display = "block";
    } else {
      formulaBox.style.display = "none";
    }
}
  </script>
</body>
</html>

</template>
  <template id="TPL_HT" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=1024"/>
  <title>Hypothesis Testing Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-pattern@1.3.0/dist/chartjs-plugin-pattern.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      padding: 40px;
    }
    .container {
      border: 2px solid #ccc;
      border-radius: 12px;
      padding: 30px;
      max-width: 700px;
      width: 100%;
      height: auto;
      background-color: #fafafa;
      text-align: center;
      overflow: visible;
    }
    .button-group button {
      margin-right: 10px;
      margin-bottom: 10px;
    }
    .button-group button.active {
      background-color: #4285f4;
      color: white;
      border: 1px solid #3367d6;
    }
    .input-group {
      margin-bottom: 10px;
      text-align: left;
    }
    .hypothesis-wrapper {
      margin-top: 20px;
      border: 1px solid #ccc;
      border-radius: 6px;
      padding: 10px;
      background-color: #fefefe;
      text-align: center;
    }
    .hypothesis-subgroup {
      margin: 10px 0;
    }
    label {
      display: inline-block;
      width: 250px;
    }
    input, select {
      padding: 4px;
    }
    #altDirection {
      margin: 0 4px;
    }
    #altValue {
      width: auto;
    }
    .result-box {
      background-color: #f4f4f4;
      padding: 15px;
      margin-top: 20px;
      border-radius: 6px;
      text-align: center;
    }
    .result-box div + div {
      margin-top: 6px;
    }
    .result-box div:first-child {
      margin-bottom: 12px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Hypothesis Testing Calculator</h2>

    <div class="input-group" style="margin-bottom: 20px;">
      <label for="alpha">Significance Level (α):</label>
      <input id="alpha" name="alpha" type="number" step="any" value="0.05" style="width: 100px;" />
    </div>

    <div class="button-group" style="display: flex; justify-content: center; align-items: center; height: 110px;">
  <button onclick="selectTestType('proportion')" style="height: 50%;">Proportion</button>
  <button onclick="selectTestType('mean')" style="height: 50%;">Mean</button>
  <div style="display: flex; flex-direction: column; align-items: center; margin: 0 10px;">
    <button onclick="selectTestType('difference')" style="width: 250px; margin-bottom: 5px;">Difference Between Two Means</button>
    <button onclick="selectTestType('diffprop')" style="width: 250px;">Difference Between Two Proportions</button>
  </div>
  <button onclick="selectTestType('paired')" style="height: 50%;">Paired Differences</button>

</div>

    <div id="inputSection" class="section"></div>
    <div id="result" class="section"></div>
    <a href="#" id="toggleGraphBtn" onclick="toggleGraph(); return false;" style="visibility: hidden; text-decoration: underline; color: #0645AD; margin-top: 20px; font-size: 0.85em; float: left;">Show/Hide Graph</a>

    <div id="graphSection" style="display: none;">
      <canvas id="proportionChart" width="600" height="300"></canvas>
    </div>
  </div>

  <script>
    let currentTestType = "";
    let chartInstance = null;

    function createLabeledInput(id, labelText, type = "number", step = "any") {
      return `<div class="input-group">
                <label for="${id}">${labelText}</label>
                <input id="${id}" name="${id}" type="${type}" step="${step}" />
              </div>`;
    }

    function createHypothesisInputs(symbol) {
      return `
        <div class="hypothesis-wrapper">
          <div class="hypothesis-subgroup">
            <strong>Null Hypothesis:</strong>
            <div>H<sub>0</sub>: ${symbol} = <input id="nullValue" type="number" step="any" style="width: 100px;" oninput="document.getElementById('altValue').textContent = this.value" /></div>
          </div>
          <div class="hypothesis-subgroup">
            <strong>Alternative Hypothesis:</strong>
            <div>H<sub>A</sub>: ${symbol}<select id="altDirection">
              <option value="lt">&lt;</option>
              <option value="gt">&gt;</option>
              <option value="neq">≠</option>
            </select><span id="altValue">0</span></div>
          </div>
        </div>
      `;
    }
    
function drawDistributionChart(stat, alpha, altDir, pValue, distType, df) {
  const ctx = document.getElementById("proportionChart").getContext("2d");
  const yValues = [], critLeft = [], critRight = [], statShadeLeft = [], statShadeRight = [];
  const minX = distType === 'z' ? -4 : -5;
  const maxX = distType === 'z' ? 4 : 5;
  const step = 0.05;
  const dist = jStat[distType === 'z' ? 'normal' : 'studentt'];
  const critLeftCutoff = altDir === 'lt'
    ? (distType === 'z' ? jStat.normal.inv(alpha, 0, 1) : jStat.studentt.inv(alpha, df))
    : altDir === 'neq'
      ? (distType === 'z' ? jStat.normal.inv(alpha / 2, 0, 1) : jStat.studentt.inv(alpha / 2, df))
      : null;

  const critRightCutoff = altDir === 'gt'
    ? (distType === 'z' ? jStat.normal.inv(1 - alpha, 0, 1) : jStat.studentt.inv(1 - alpha, df))
    : altDir === 'neq'
      ? (distType === 'z' ? jStat.normal.inv(1 - alpha / 2, 0, 1) : jStat.studentt.inv(1 - alpha / 2, df))
      : null;


  for (let x = minX; x <= maxX; x += step) {
    const y = distType === 'z' ? dist.pdf(x, 0, 1) : dist.pdf(x, df);
    yValues.push({ x, y });

    if (critLeftCutoff !== null && x < critLeftCutoff) critLeft.push({ x, y });
    if (critRightCutoff !== null && x > critRightCutoff) critRight.push({ x, y });

    if (altDir === 'lt' && x <= stat) statShadeLeft.push({ x, y });
    if (altDir === 'gt' && x >= stat) statShadeRight.push({ x, y });
    if (altDir === 'neq') {
      if (x <= -Math.abs(stat)) statShadeLeft.push({ x, y });
      if (x >= Math.abs(stat)) statShadeRight.push({ x, y });
    }
  }

  if (chartInstance) chartInstance.destroy();
  const stripeCanvas = document.createElement('canvas');
  stripeCanvas.width = 10;
  stripeCanvas.height = 10;
  const stripeCtx = stripeCanvas.getContext('2d');
  stripeCtx.strokeStyle = 'rgba(255, 0, 0, 0.3)';
  stripeCtx.lineWidth = 2;
  stripeCtx.beginPath();
  stripeCtx.moveTo(0, 10);
  stripeCtx.lineTo(10, 0);
  stripeCtx.stroke();
  const pattern = ctx.createPattern(stripeCanvas, 'repeat');

  chartInstance = new Chart(ctx, {
    type: 'line',
    data: {
      datasets: [
        { label: distType === 'z' ? 'Standard Normal (μ = 0, σ = 1)' : `t-Distribution (df = ${df})`, data: yValues, borderColor: 'black', borderWidth: 1, fill: false, pointRadius: 0 },
        { label: 'Critical Region', data: critLeft.concat([{ x: NaN, y: NaN }], critRight), hidden: true, type: 'line', pointRadius: 0, fill: true, backgroundColor: pattern, borderWidth: 0 },
        { label: 'P-Value Region', data: statShadeLeft.concat([{ x: NaN, y: NaN }], statShadeRight), backgroundColor: pValue < alpha ? 'rgba(0, 200, 0, 0.5)' : 'rgba(255, 50, 50, 0.5)', borderWidth: 0, type: 'line', pointRadius: 0, fill: { target: 'origin' } },
        { label: 'Test Statistic', data: [
          { x: stat, y: distType === 'z' ? jStat.normal.pdf(stat, 0, 1) : jStat.studentt.pdf(stat, df) },
          { x: stat, y: 0 }
        ], type: 'line', borderColor: 'black', borderWidth: 2, pointRadius: 0, fill: false }
      ]
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: true,
          labels: {
            usePointStyle: true,
            pointStyle: 'rect'
          },
          onClick: (e, legendItem, legend) => {
            const index = legendItem.datasetIndex;
            const ci = legend.chart;
            const meta = ci.getDatasetMeta(index);
            meta.hidden = meta.hidden === null ? !ci.data.datasets[index].hidden : null;
            ci.update();
          }
        },
        tooltip: { enabled: true }
      },
      scales: {
        x: { type: 'linear', min: minX, max: maxX, title: { display: true, text: distType } },
        y: { beginAtZero: true, title: { display: false } }
      }
    }
  });
}

  
  function selectTestType(type) {
  const buttons = document.querySelectorAll('.button-group button');
  buttons.forEach(btn => btn.classList.remove('active'));
  const clickedButton = Array.from(buttons).find(btn => {
    if (type === 'diffprop') return btn.textContent.includes('Difference Between Two Proportions');
    if (type === 'difference') return btn.textContent.includes('Difference Between Two Means');
    return btn.textContent.toLowerCase().includes(type);
  });
  if (clickedButton) clickedButton.classList.add('active');
  currentTestType = type;
  let html = '';

  if (type === 'proportion') {
    html = createLabeledInput("successes", "Number of Successes:") +
           createLabeledInput("total", "Total Sample Size:") +
           '<div style="margin-top:20px"></div>' +
           createHypothesisInputs("p");

  } else if (type === 'mean') {
    html = createLabeledInput("mean", "Sample Mean:") +
       createLabeledInput("size", "Sample Size (n):") +
       `<div class="input-group">
          <label for="knowPopSD">Do you know the population SD?</label>
          <select id="knowPopSD">
            <option value="no" selected>No</option>
            <option value="yes">Yes</option>
          </select>
        </div>` +
       `<div class="input-group">
          <label id="sdLabel" for="sampleSD">Sample Standard Deviation (s):</label>
          <input id="sampleSD" name="sampleSD" type="number" step="any" />
        </div>` +
       '<div style="margin-top:20px"></div>' +
       createHypothesisInputs("μ");

    setTimeout(() => {
  const select = document.getElementById('knowPopSD');
  const label = document.getElementById('sdLabel');
  if (select && label) {
    const updateLabel = () => {
      label.textContent = select.value === 'yes'
        ? 'Population SD (σ):'
        : 'Sample SD (s):';
    };
    updateLabel();
    select.addEventListener('change', updateLabel);
  }
}, 0);


  } else if (type === 'difference') {
    html = createLabeledInput("mean1", "Sample Mean 1 (x̄₁):") +
           createLabeledInput("sd1", "Sample SD 1 (s₁):") +
           createLabeledInput("n1", "Sample Size 1 (n₁):") +
           createLabeledInput("mean2", "Sample Mean 2 (x̄₂):") +
           createLabeledInput("sd2", "Sample SD 2 (s₂):") +
           createLabeledInput("n2", "Sample Size 2 (n₂):") +
           `<div class="input-group" style="display: flex; flex-direction: column; align-items: flex-start;">
  <strong>Degrees of Freedom Method:</strong>
  <div style="display: flex; gap: 20px; flex-wrap: nowrap;">
    <label><input type="radio" name="dfMethod" value="welch" checked> Unequal Variances (recommended)</label>
    <label><input type="radio" name="dfMethod" value="pooled"> Equal Variances (pooled)</label>
    <label><input type="radio" name="dfMethod" value="min"> Simplified (minimum)</label>
  </div>
            </div>` +
           '<div style="margin-top:20px"></div>' +
           createHypothesisInputs("μ₁ - μ₂");
  

  } else if (type === 'paired') {
    html = createLabeledInput("meanDiff", "Mean of Differences (x̄<sub>d</sub>):") +
           createLabeledInput("sdDiff", "SD of Differences (s<sub>d</sub>):") +
           createLabeledInput("nDiff", "Sample Size (n):") +
           '<div style="margin-top:20px"></div>' +
           createHypothesisInputs("μ<sub>d</sub>");

  } else if (type === 'diffprop') {
    html = createLabeledInput("x1", "Sample 1 Successes (x₁):") +
           createLabeledInput("n1", "Sample 1 Size (n₁):") +
           createLabeledInput("x2", "Sample 2 Successes (x₂):") +
           createLabeledInput("n2", "Sample 2 Size (n₂):") +
           '<div style="margin-top:20px"></div>' +
           createHypothesisInputs("p₁ - p₂");
  }

  html += `<button onclick="calculate()">Calculate</button>`;
  document.getElementById("inputSection").innerHTML = html;
  document.getElementById("result").innerHTML = "";
  document.getElementById('graphSection').style.display = 'none';
  document.getElementById('toggleGraphBtn').style.visibility = 'hidden';
  if (chartInstance) {
    chartInstance.destroy();
    chartInstance = null;
  }
  if (window.MathJax) MathJax.typesetPromise();
}


    function getValue(id) {
      const el = document.getElementById(id);
      if (!el || el.value.trim() === '') {
        alert(`Please enter a value for ${id}`);
        throw new Error(`Missing value: ${id}`);
      }
      return parseFloat(el.value);
    }

function toggleGraph() {
      const section = document.getElementById('graphSection');
      section.style.display = section.style.display === 'block' ? 'none' : 'block';
    }

function maybeDrawProportionChart(testType, stat, alpha, altDir, pValue, df = null) {
  document.getElementById('toggleGraphBtn').style.display = 'inline';
  const distType = testType === 'mean' ? (df === null ? 'z' : 't') : (testType.includes('prop') ? 'z' : 't');
drawDistributionChart(stat, alpha, altDir, pValue, distType, df);
}

function calculate() {
      const alphaValue = document.getElementById("alpha").value;
      if (alphaValue.trim() === '' || isNaN(alphaValue) || alphaValue <= 0 || alphaValue >= 1) {
        alert("Please enter a significance level (α) between 0 and 1.");
        return;
      }
      const alpha = parseFloat(alphaValue);
      const altDir = document.getElementById("altDirection").value;
      const nullVal = getValue("nullValue");
      const resultBox = document.getElementById("result");
      let pValue = null;
      let resultDetails = "";

      if (currentTestType === 'proportion') {
        const successes = getValue("successes");
        const total = getValue("total");
        const phat = successes / total;
        const se = Math.sqrt(nullVal * (1 - nullVal) / total);
        const z = (phat - nullVal) / se;
        const zCrit = jStat.normal.inv(1 - alpha / (altDir === 'neq' ? 2 : 1), 0, 1);
        pValue = altDir === "lt" ? jStat.normal.cdf(z, 0, 1)
                : altDir === "gt" ? 1 - jStat.normal.cdf(z, 0, 1)
                : 2 * (1 - jStat.normal.cdf(Math.abs(z), 0, 1));
        resultDetails += `<div><strong>P-value:</strong> <span style='color:${pValue < alpha ? 'green' : 'red'}'>${pValue.toFixed(6)}</span></div>`;
        resultDetails += `<div>Test Statistic (z): ${z.toFixed(4)}</div>`;
        resultDetails += `<div>Critical Value${altDir === 'neq' ? 's' : ''}: ±${zCrit.toFixed(4)}</div>`;
        resultDetails += `<div>Standard Error: ${se.toFixed(4)}</div>`;
        resultDetails += `<div>Critical Region: ${altDir === 'lt' ? 'z < -' + zCrit.toFixed(4) : altDir === 'gt' ? 'z > ' + zCrit.toFixed(4) : '|z| > ' + zCrit.toFixed(4)}</div>`;
	maybeDrawProportionChart(currentTestType, z, alpha, altDir, pValue);


      } else if (currentTestType === 'mean') {
        const mean = getValue("mean");
        const n = getValue("size");
        const sd = getValue("sampleSD");
        const useZ = document.getElementById('knowPopSD').value === 'yes';
        const se = sd / Math.sqrt(n);
        const stat = (mean - nullVal) / se;

        let crit, distType;
        if (useZ) {
          crit = jStat.normal.inv(1 - alpha / (altDir === 'neq' ? 2 : 1), 0, 1);
          pValue = altDir === "lt" ? jStat.normal.cdf(stat, 0, 1)
                  : altDir === "gt" ? 1 - jStat.normal.cdf(stat, 0, 1)
                  : 2 * (1 - jStat.normal.cdf(Math.abs(stat), 0, 1));
          distType = 'z';
        } else {
          crit = jStat.studentt.inv(1 - alpha / (altDir === 'neq' ? 2 : 1), n - 1);
          pValue = altDir === "lt" ? jStat.studentt.cdf(stat, n - 1)
                  : altDir === "gt" ? 1 - jStat.studentt.cdf(stat, n - 1)
                  : 2 * (1 - jStat.studentt.cdf(Math.abs(stat), n - 1));
          distType = 't';
        }

        maybeDrawProportionChart(currentTestType, stat, alpha, altDir, pValue, useZ ? null : n - 1);

        resultDetails += `<div><strong>P-value:</strong> <span style='color:${pValue < alpha ? 'green' : 'red'}'>${pValue.toFixed(6)}</span></div>`;
        resultDetails += `<div>Test Statistic (${distType}): ${stat.toFixed(4)}</div>`;
        resultDetails += `<div>Critical Value${altDir === 'neq' ? 's' : ''}: ±${crit.toFixed(4)}</div>`;
        resultDetails += `<div>Standard Error: ${se.toFixed(4)}</div>`;
        if (!useZ) {
          resultDetails += `<div>Degrees of Freedom: ${n - 1}</div>`;
        }
        resultDetails += `<div>Critical Region: ${altDir === 'lt' ? distType + ' < -' + crit.toFixed(4)
          : altDir === 'gt' ? distType + ' > ' + crit.toFixed(4)
          : '|' + distType + '| > ' + crit.toFixed(4)}</div>`;

      } else if (currentTestType === 'paired') {
        const mean = getValue(currentTestType === 'mean' ? "mean" : "meanDiff");
        const n = getValue(currentTestType === 'mean' ? "size" : "nDiff");
        const s = getValue(currentTestType === 'mean' ? "sampleSD" : "sdDiff");
        const se = s / Math.sqrt(n);
        const t = (mean - nullVal) / se;
        const tCrit = jStat.studentt.inv(1 - alpha / (altDir === 'neq' ? 2 : 1), n - 1);
        pValue = altDir === "lt" ? jStat.studentt.cdf(t, n - 1)
                : altDir === "gt" ? 1 - jStat.studentt.cdf(t, n - 1)
                : 2 * (1 - jStat.studentt.cdf(Math.abs(t), n - 1));
        maybeDrawProportionChart(currentTestType, t, alpha, altDir, pValue, n - 1);

        resultDetails += `<div><strong>P-value:</strong> <span style='color:${pValue < alpha ? 'green' : 'red'}'>${pValue.toFixed(6)}</span></div>`;
        resultDetails += `<div>Test Statistic (t): ${t.toFixed(4)}</div>`;
        resultDetails += `<div>Critical Value${altDir === 'neq' ? 's' : ''}: ±${tCrit.toFixed(4)}</div>`;
        resultDetails += `<div>Standard Error: ${se.toFixed(4)}</div>`;
        resultDetails += `<div>Degrees of Freedom: ${n - 1}</div>`;
        resultDetails += `<div>Critical Region: ${altDir === 'lt' ? 't < -' + tCrit.toFixed(4) : altDir === 'gt' ? 't > ' + tCrit.toFixed(4) : '|t| > ' + tCrit.toFixed(4)}</div>`;

      }else if (currentTestType === 'difference') {
        const m1 = getValue("mean1");
        const s1 = getValue("sd1");
        const n1 = getValue("n1");
        const m2 = getValue("mean2");
        const s2 = getValue("sd2");
        const n2 = getValue("n2");
        const diff = m1 - m2;
        const se = Math.sqrt(s1 ** 2 / n1 + s2 ** 2 / n2);
        let dfMethod = document.querySelector('input[name="dfMethod"]:checked')?.value || 'welch';
let df;
if (dfMethod === 'welch') {
  df = (Math.pow(se, 4) / ((Math.pow(s1 ** 2 / n1, 2) / (n1 - 1)) + (Math.pow(s2 ** 2 / n2, 2) / (n2 - 1))));
} else if (dfMethod === 'pooled') {
  df = n1 + n2 - 2;
} else {
  df = Math.min(n1, n2) - 1;
}
        const t = (diff - nullVal) / se;
        const tCrit = jStat.studentt.inv(1 - alpha / (altDir === 'neq' ? 2 : 1), df);
        pValue = altDir === "lt" ? jStat.studentt.cdf(t, df)
                : altDir === "gt" ? 1 - jStat.studentt.cdf(t, df)
                : 2 * (1 - jStat.studentt.cdf(Math.abs(t), df));
        maybeDrawProportionChart(currentTestType, t, alpha, altDir, pValue, df);

        resultDetails += `<div><strong>P-value:</strong> <span style='color:${pValue < alpha ? 'green' : 'red'}'>${pValue.toFixed(6)}</span></div>`;
        resultDetails += `<div>Test Statistic (t): ${t.toFixed(4)}</div>`;
        resultDetails += `<div>Critical Value${altDir === 'neq' ? 's' : ''}: ±${tCrit.toFixed(4)}</div>`;
        resultDetails += `<div>Standard Error: ${se.toFixed(4)}</div>`;
        resultDetails += `<div>Degrees of Freedom: ${df.toFixed(3)}</div>`;
        resultDetails += `<div>Critical Region: ${altDir === 'lt' ? 't < -' + tCrit.toFixed(4) : altDir === 'gt' ? 't > ' + tCrit.toFixed(4) : '|t| > ' + tCrit.toFixed(4)}</div>`;

      } else if (currentTestType === 'diffprop') {
	  const x1 = getValue("x1");
	  const n1 = getValue("n1");
	  const x2 = getValue("x2");
	  const n2 = getValue("n2");
	  const p1_hat = x1 / n1;
	  const p2_hat = x2 / n2;
	  const p_hat = (x1 + x2) / (n1 + n2);
	  const se = Math.sqrt(p_hat * (1 - p_hat) * (1/n1 + 1/n2));
	  const z = ((p1_hat - p2_hat) - nullVal) / se;
	  const zCrit = jStat.normal.inv(1 - alpha / (altDir === 'neq' ? 2 : 1), 0, 1);
	  pValue = altDir === "lt" ? jStat.normal.cdf(z, 0, 1)
        	  : altDir === "gt" ? 1 - jStat.normal.cdf(z, 0, 1)
      		  : 2 * (1 - jStat.normal.cdf(Math.abs(z), 0, 1));
 	 resultDetails += `<div><strong>P-value:</strong> <span style='color:${pValue < alpha ? 'green' : 'red'}'>${pValue.toFixed(6)}</span></div>`;
 	 resultDetails += `<div>Test Statistic (z): ${z.toFixed(4)}</div>`;
	  resultDetails += `<div>Critical Value${altDir === 'neq' ? 's' : ''}: ±${zCrit.toFixed(4)}</div>`;
	  resultDetails += `<div>Standard Error: ${se.toFixed(4)}</div>`;
	  resultDetails += `<div>Critical Region: ${altDir === 'lt' ? 'z < -' + zCrit.toFixed(4) : altDir === 'gt' ? 'z > ' + zCrit.toFixed(4) : '|z| > ' + zCrit.toFixed(4)}</div>`;
	  maybeDrawProportionChart(currentTestType, z, alpha, altDir, pValue);
       }

      resultBox.innerHTML = `<div class='result-box'>${resultDetails}</div>`;
      document.getElementById('toggleGraphBtn').style.visibility = 'visible';

    }
  </script>
</body>
</html> 

</template>

  <template id="TPL_INDEP" class="inline-tool">
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Chi-Square Test of Independence</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      display: block;
    }
    .wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    table {
      border-collapse: collapse;
      margin-bottom: 0;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 6px;
      text-align: center;
      min-width: 60px;
    }
    input[type="text"], input[type="number"] {
      width: 100%;
      box-sizing: border-box;
      text-align: center;
    }
    .button-row {
      margin: 20px 0 10px;
    }
        .controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .add-remove-row {
      display: flex;
      gap: 5px;
      margin-left: 62px;
      margin-top: 10px;
    }
    .column-button-container {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-left: 5px;
      margin-top: 30px;
    }
    button {
      padding: 2px 6px;
      font-size: 12px;
    }
    .expected {
      font-size: 0.8em;
    }
    .overlay-expected {
      color: black;
    }
    .overlay-contrib {
      color: #003366;
    }
    .overlay-resid {
      color: #663399;
    }
    .overlay-stdresid {
      color: #4a90e2;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jstat/1.9.5/jstat.min.js"></script>
</head>
<body style="background-color: white;">
  <!-- Begin full GUI wrapper -->
<div style="border: 1px solid #ccc; padding: 20px; margin: 0 auto; max-width: 900px; background-color: #f9f9f9;">
    <div style="text-align: center;">
  <h2 style="margin-bottom: 0;">Chi-Square Test of Independence</h2>
  <div style="margin-top: 10px; margin-bottom: 20px; font-weight: normal;">
    <label for="alphaInput">Significance Level α = </label>
    <input type="number" id="alphaInput" value="0.05" min="0.001" max="0.999" step="0.001" style="width: 60px; text-align: center;">
  </div>
</div>

<table id="legend" style="align-self: flex-start; margin-bottom: 10px; border-collapse: collapse; display: none;">
  <caption style="caption-side: top; font-weight: bold; text-align: left;">Legend:</caption>
  <tr>
  <td style="border: 1px solid #ccc; padding: 6px; text-align: center; min-width: 60px;">
    <div style="display: inline-block; padding: 2px 6px; border: 1px solid #ccc; background-color: white; border-radius: 4px;">
      Count
    </div>
    <br>
    <span id="legend-values" style="font-size: 0.8em;"></span>
  </td>
</tr>
</table>
  
    <div style="text-align: center; margin-top: 10px;">
  <button onclick="resetTable()">Reset</button>
</div>

    <div style="display: flex; align-items: center; justify-content: center;">
  <div id="table-container"></div>
  <div class="column-button-container">
    <button style="width: 24px; height: 24px;" onclick="addColumn()">+</button>
    <button style="width: 24px; height: 24px;" onclick="removeColumn()">−</button>
  </div>
</div>


      <div class="add-remove-row" style="display: flex; justify-content: center; margin-top: 10px; gap: 5px;">
  <button style="width: 24px; height: 24px;" onclick="addRow()">+</button>
  <button style="width: 24px; height: 24px;" onclick="removeRow()">−</button>
</div>
<div style="text-align: center; margin-top: 10px;">
  <button id="calculate-btn" onclick="calculateChiSquare()" style="font-size: 16px; padding: 6px 12px;">Calculate</button>
</div>
<div class="button-row" id="toggle-controls" style="text-align: center; display: none;">
  <input type="checkbox" id="toggle-expected" onchange="toggleOverlay('expected')">
  <label for="toggle-expected">Expected Count</label>

  <input type="checkbox" id="toggle-contrib" onchange="toggleOverlay('contrib')">
  <label for="toggle-contrib">χ² Contrib.</label>

  <input type="checkbox" id="toggle-resid" onchange="toggleOverlay('resid')">
  <label for="toggle-resid">Residual</label>

  <input type="checkbox" id="toggle-stdresid" onchange="toggleOverlay('stdresid')">
  <label for="toggle-stdresid">Std. Residual</label>
</div>
<div id="results"
 style="margin: 20px auto 0; border: 2px solid #4da6ff; background-color: #e6f3ff; padding: 10px; max-width: 400px; display: none; text-align: center;"></div>
  </div>

  <script>
    // Disable Calculate button if any overlay checkbox is checked
    document.addEventListener('DOMContentLoaded', function () {
      const checkboxes = ['expected', 'contrib', 'resid', 'stdresid'];
      checkboxes.forEach(id => {
        document.getElementById(`toggle-${id}`).addEventListener('change', () => {
          const anyChecked = checkboxes.some(id => document.getElementById(`toggle-${id}`).checked);
          document.getElementById('calculate-btn').disabled = anyChecked;
        });
      });
    });
    let numRows = 4;
    let numCols = 4;

    function createTable() {
  const handleArrowNavigation = (e) => {
    const input = e.target;
    const cell = input.closest('td');
    const row = cell?.parentElement;
    const table = row?.parentElement?.parentElement;
    if (!table) return;

    const rowIndex = Array.from(row.parentElement.children).indexOf(row);
    const colIndex = Array.from(row.children).indexOf(cell);

    let targetInput;

    if (e.key === 'ArrowUp') {
      if (rowIndex > 0) {
        targetInput = table.rows[rowIndex - 1].cells[colIndex]?.querySelector('input');
      }
    } else if (e.key === 'ArrowDown') {
      if (rowIndex < table.rows.length - 1) {
        targetInput = table.rows[rowIndex + 1].cells[colIndex]?.querySelector('input');
      }
    } else if (e.key === 'ArrowLeft') {
      if (colIndex > 0) {
        targetInput = row.cells[colIndex - 1]?.querySelector('input');
      }
    } else if (e.key === 'ArrowRight') {
      if (colIndex < row.cells.length - 1) {
        targetInput = row.cells[colIndex + 1]?.querySelector('input');
      }
    }

    if (targetInput) {
      e.preventDefault();
      targetInput.focus();
    }
  };
  const container = document.getElementById('table-container');
  const prevData = [];
  const prevLabels = { row: [], col: [] };

  const oldTable = document.getElementById('data-table');
  if (oldTable) {
    for (let i = 1; i < oldTable.rows.length; i++) {
      prevData[i - 1] = [];
      for (let j = 1; j < oldTable.rows[i].cells.length; j++) {
        const input = oldTable.rows[i].cells[j].querySelector('input');
        prevData[i - 1][j - 1] = input ? input.value : '';
      }
    }
    for (let i = 1; i < oldTable.rows.length; i++) {
      const labelInput = oldTable.rows[i].cells[0].querySelector('input');
      prevLabels.row[i - 1] = labelInput ? labelInput.value : `Row ${i}`;
    }
    for (let j = 1; j < oldTable.rows[0].cells.length; j++) {
      const labelInput = oldTable.rows[0].cells[j].querySelector('input');
      prevLabels.col[j - 1] = labelInput ? labelInput.value : `Column ${j}`;
    }
  }

  container.innerHTML = '';
  const table = document.createElement('table');
  table.id = "data-table";
  const tbody = document.createElement('tbody');

  for (let i = 0; i < numRows; i++) {
    const row = document.createElement('tr');
    for (let j = 0; j < numCols; j++) {
      const cell = document.createElement(i === 0 || j === 0 ? 'th' : 'td');
      const input = document.createElement('input');
      input.type = (i === 0 || j === 0) ? 'text' : 'number';
      input.placeholder = (i === 0 && j > 0) ? `Column ${j}` : (j === 0 && i > 0) ? `Row ${i}` : '';
      if (i === 0 && j > 0) input.value = prevLabels.col[j - 1] || `Column ${j}`;
      // Remove top-left input box
      if (i === 0 && j === 0) {
        row.appendChild(document.createElement('th'));
        continue;
      }
      if (j === 0 && i > 0) input.value = prevLabels.row[i - 1] || `Row ${i}`;
      if (i > 0 && j > 0) input.value = (prevData[i - 1] && prevData[i - 1][j - 1]) || '';
      input.addEventListener('input', clearResults);
      input.addEventListener('keydown', handleArrowNavigation);
      cell.appendChild(input);
      row.appendChild(cell);
    }
    tbody.appendChild(row);
  }

  table.appendChild(tbody);
  container.appendChild(table);
    }

    function clearResults() {
  const table = document.getElementById('data-table');
  if (!table) return;
      while (table.rows.length > numRows) table.deleteRow(-1);
      for (let i = 0; i < table.rows.length; i++) {
        while (table.rows[i].cells.length > numCols) table.rows[i].deleteCell(-1);
        if (i > 0) {
          const cell = table.rows[i].cells[numCols - 1];
          if (cell && cell.childNodes.length > 1) {
            cell.innerHTML = '';
            const input = document.createElement('input');
            input.type = 'number';
            input.addEventListener('input', clearResults);
            table.rows[i].cells[numCols - 1].appendChild(input);
          }
        }
      }
    }

    function addRow() {
  numRows++;
  createTable();
}

    function removeRow() {
      if (numRows > 3) {
        numRows--;
        createTable();
      }
    }

    function addColumn() {
      numCols++;
      createTable();
    }

    function removeColumn() {
      if (numCols > 3) {
        numCols--;
        createTable();
      }
    }

function resetTable() {
  // Reset defaults
  numRows = 4;
  numCols = 4;

  // Hide and clear results
  const results = document.getElementById('results');
  results.style.display = 'none';
  results.innerHTML = '';

  // Hide toggle controls and legend
  document.getElementById('toggle-controls').style.display = 'none';
  document.getElementById('legend').style.display = 'none';
  document.getElementById('legend-values').innerHTML = '';

  // Reset overlay tracking
  window._lastExpected = null;
  window._lastValidRows = null;
  window._lastValidCols = null;
  window._shownMetrics = { expected: false, contrib: false, resid: false, stdresid: false };

  // Restore +/- column buttons if missing
  if (!document.querySelector('.column-button-container')) {
    const colControls = document.createElement('div');
    colControls.className = 'column-button-container';
    colControls.innerHTML = `
      <button style="width: 24px; height: 24px;" onclick="addColumn()">+</button>
      <button style="width: 24px; height: 24px;" onclick="removeColumn()">−</button>
    `;
    document.getElementById('table-container').after(colControls);
  }

  // Restore +/- row buttons if missing
  if (!document.querySelector('.add-remove-row')) {
    const rowControls = document.createElement('div');
    rowControls.className = 'add-remove-row';
    rowControls.style.display = 'flex';
    rowControls.style.justifyContent = 'center';
    rowControls.style.marginTop = '10px';
    rowControls.style.gap = '5px';
    rowControls.innerHTML = `
      <button style="width: 24px; height: 24px;" onclick="addRow()">+</button>
      <button style="width: 24px; height: 24px;" onclick="removeRow()">−</button>
    `;
    const calcBtnContainer = document.querySelector('#calculate-btn').parentElement;
    calcBtnContainer.before(rowControls);
  }
  document.getElementById('calculate-btn').disabled = false; 

  // Recreate the table
  createTable();

  // Clear all non-label cells
  const table = document.getElementById('data-table');
  if (table) {
    for (let i = 1; i < numRows; i++) {
      for (let j = 1; j < numCols; j++) {
        const input = table.rows[i].cells[j].querySelector('input');
        if (input) input.value = '';
      }
    }
  }
}


createTable();
  window._legendOrder = [];
  createTable();


function updateLegend(labels) {
  const span = document.getElementById('legend-values');
  if (span) {
    const seen = new Set();
    const ordered = labels.filter(label => {
      if (!seen.has(label)) {
        seen.add(label);
        return true;
      }
      return false;
    });
    const colorMap = {
      'Expected': 'black',
      'Chi-Square Contribution': '#003366',
      'Chi-Square Residual': '#663399',
      'Standardized Residual': '#4a90e2'
    };
    const extra = ordered.slice(1).map(label => {
      const color = colorMap[label] || 'gray';
      return `<span style='color: ${color}'>(${label})</span>`;
    }).join('<br>');
    span.innerHTML = extra;
  }
}

function calculateChiSquare() {
  // Remove +/- buttons
  const rowControls = document.querySelector('.add-remove-row');
  const colControls = document.querySelector('.column-button-container');
  if (rowControls) rowControls.remove();
  if (colControls) colControls.remove();
  const table = document.getElementById('data-table');
  if (!table) return;
  // Clear any previous overlays
  const observed = [];
  const rowLabels = [];
  const colLabels = [];

  for (let i = 1; i < numRows; i++) {
    const row = [];
    for (let j = 1; j < numCols; j++) {
      const val = table.rows[i].cells[j].firstChild.value;
      const num = parseFloat(val);
      row.push(!isNaN(num) ? num : null);
    }
    if (row.some(x => x !== null)) {
      observed.push(row);
      rowLabels.push(table.rows[i].cells[0].firstChild.value || `Row ${i}`);
    }
  }

  for (let j = 1; j < numCols; j++) {
    let valid = false;
    for (let i = 1; i < numRows; i++) {
      if (table.rows[i].cells[j].firstChild.value !== '') valid = true;
    }
    if (valid) colLabels.push(table.rows[0].cells[j].firstChild.value || `Column ${j}`);
  }

  const validCols = colLabels.map((_, j) => observed.some(row => row[j] !== null));
  const cleanObserved = observed.map(row => row.filter((_, j) => validCols[j]));
  const finalColLabels = colLabels.filter((_, j) => validCols[j]);

  const r = cleanObserved.length;
  const c = finalColLabels.length;
  const rowTotals = cleanObserved.map(row => row.reduce((sum, val) => sum + (val ?? 0), 0));
  const colTotals = Array(c).fill(0);
  for (let j = 0; j < c; j++) {
    for (let i = 0; i < r; i++) {
      colTotals[j] += cleanObserved[i][j] ?? 0;
    }
  }
  const grandTotal = rowTotals.reduce((a, b) => a + b, 0);

  const expected = [];
  for (let i = 0; i < r; i++) {
    expected[i] = [];
    for (let j = 0; j < c; j++) {
      expected[i][j] = (rowTotals[i] * colTotals[j]) / grandTotal;
    }
  }

  let chi2 = 0;
  for (let i = 0; i < r; i++) {
    for (let j = 0; j < c; j++) {
      const O = cleanObserved[i][j] ?? 0;
      const E = expected[i][j];
      if (E > 0) {
        chi2 += Math.pow(O - E, 2) / E;
      }
    }
  }

  const df = (r - 1) * (c - 1);
  const p = 1 - jStat.chisquare.cdf(chi2, df);

  let messages = '';

  // Check for expected counts < 5
  let smallExpected = false;
  for (let i = 0; i < r; i++) {
    for (let j = 0; j < c; j++) {
      if (expected[i][j] < 5) {
        smallExpected = true;
        break;
      }
    }
  }
  if (smallExpected) {
    messages += '<p style="color: red;"><strong>Warning:</strong> Some cells have an expected count less than 5. Chi-Square is suspect.</p>';
  }

  // Check for blanks in rows/columns with non-blank values
  let blanksWarning = false;
  for (let i = 0; i < cleanObserved.length; i++) {
    let nonBlank = cleanObserved[i].some(v => v !== null);
    let hasBlank = cleanObserved[i].some(v => v === null);
    if (nonBlank && hasBlank) {
      blanksWarning = true;
      break;
    }
  }
  if (!blanksWarning) {
    for (let j = 0; j < cleanObserved[0].length; j++) {
      let colHas = cleanObserved.map(row => row[j]);
      let nonBlank = colHas.some(v => v !== null);
      let hasBlank = colHas.some(v => v === null);
      if (nonBlank && hasBlank) {
        blanksWarning = true;
        break;
      }
    }
  }
  if (blanksWarning) {
    alert('Warning: Blank cells in partially filled rows or columns are treated as 0.');
  }

  // Check for minimum 2 rows and 2 columns
  if (r < 2 || c < 2) {
    alert('Error: At least two rows and two columns of data are required.');
    return;
  }

  const alpha = parseFloat(document.getElementById('alphaInput').value);
  const critical = jStat.chisquare.inv(1 - alpha, df);
  const pColor = p < alpha ? 'green' : 'red';

  document.getElementById('results').innerHTML = `<div style="line-height: 1.2;">
  <span><strong>p-value:</strong> <span style="color:${pColor}; font-weight:bold;">${p.toFixed(6)}</span></span><br>
  <span>Chi-Square Statistic: ${chi2.toFixed(4)}</span><br>
  <span>Degrees of Freedom: ${df}</span><br>
  <span>Critical Chi-Square Value: ${critical.toFixed(4)}</span>
</div>
<br>${messages}`;

document.getElementById('results').style.display = 'block';
document.getElementById('toggle-controls').style.display = 'block';
const legend = document.getElementById('legend');
  if (legend) legend.style.display = 'table';
  window._lastExpected = expected;
  window._lastValidRows = r;
  window._lastValidCols = c;
  
  updateLegend(['Count']);
window._shownMetrics = { expected: false, contrib: false, resid: false, stdresid: false };

  while (table.rows.length > r + 1) table.deleteRow(-1);
  for (let i = 0; i < table.rows.length; i++) {
    while (table.rows[i].cells.length > c + 1) table.rows[i].deleteCell(-1);
  }

  const totalRow = table.insertRow(-1);
  const labelCell = totalRow.insertCell(0);
  labelCell.innerHTML = '<strong>Total</strong>';
  for (let j = 0; j < c; j++) {
    const cell = totalRow.insertCell(j + 1);
    cell.innerHTML = colTotals[j] !== undefined ? '<strong>' + colTotals[j].toFixed(2) + '</strong>' : '';
  }
  const grandCell = totalRow.insertCell(-1);
  grandCell.innerHTML = '<strong>' + grandTotal.toFixed(2) + '</strong>';

  for (let i = 0; i < r; i++) {
    const cell = table.rows[i + 1].insertCell(-1);
    cell.innerHTML = rowTotals[i] !== undefined ? '<strong>' + rowTotals[i].toFixed(2) + '</strong>' : '';
  }
  const headerTotal = table.rows[0].insertCell(-1);
  headerTotal.innerHTML = '<strong>Total</strong>';
}

function showExpected() {
  if (window._shownMetrics.expected) return;
  window._shownMetrics.expected = true;
  window._legendOrder = window._legendOrder || [];
  window._legendOrder.push('Expected');
  const table = document.getElementById('data-table');
  const expected = window._lastExpected;
  const r = window._lastValidRows;
  const c = window._lastValidCols;

  for (let i = 1; i <= r; i++) {
    for (let j = 1; j <= c; j++) {
      const cell = table.rows[i].cells[j];
      if (cell) {
        const display = document.createElement('div');
        display.className = 'expected';
        display.textContent = `(${expected[i - 1][j - 1].toFixed(3)})`;
        cell.appendChild(display);
      }
    }
  }
  document.getElementById('show-expected-btn').style.display = 'none';
  updateLegend(['Count'].concat(window._legendOrder));
}
createTable();

    
function showContributions() {
  if (window._shownMetrics.contrib) return;
  window._shownMetrics.contrib = true;
  window._legendOrder = window._legendOrder || [];
  window._legendOrder.push('Contribution');
  document.getElementById('show-contrib-btn').style.display = 'none';
  const table = document.getElementById('data-table');
  const expected = window._lastExpected;
  const r = window._lastValidRows;
  const c = window._lastValidCols;

  for (let i = 1; i <= r; i++) {
    for (let j = 1; j <= c; j++) {
      const cell = table.rows[i].cells[j];
      if (cell && !cell.innerHTML.includes('contrib')) {
        const O = parseFloat(cell.firstChild.value);
        const E = expected[i - 1][j - 1];
        const contrib = E > 0 ? Math.pow(O - E, 2) / E : 0;
        const display = document.createElement('div');
        display.className = 'expected';
        display.textContent = `(${contrib.toFixed(3)})`;
        cell.appendChild(display);
      }
    }
  }
  updateLegend(['Count'].concat(window._legendOrder = window._legendOrder || []).filter((v, i, a) => a.indexOf(v) === i));
}

function showResiduals() {
  if (window._shownMetrics.resid) return;
  window._shownMetrics.resid = true;
  window._legendOrder = window._legendOrder || [];
  window._legendOrder.push('Residual');
  document.getElementById('show-resid-btn').style.display = 'none';
  const table = document.getElementById('data-table');
  const expected = window._lastExpected;
  const r = window._lastValidRows;
  const c = window._lastValidCols;

  for (let i = 1; i <= r; i++) {
    for (let j = 1; j <= c; j++) {
      const cell = table.rows[i].cells[j];
      if (cell && !cell.innerHTML.includes('resid')) {
        const O = parseFloat(cell.firstChild.value);
        const E = expected[i - 1][j - 1];
        const resid = O - E;
        const display = document.createElement('div');
        display.className = 'expected';
        display.textContent = `(${resid.toFixed(3)})`;
        cell.appendChild(display);
      }
    }
  }
  updateLegend(['Count'].concat(window._legendOrder));
}

function showStandardizedResiduals() {
  if (window._shownMetrics.stdresid) return;
  window._shownMetrics.stdresid = true;
  window._legendOrder = window._legendOrder || [];
  window._legendOrder.push('Standardized Residual');
  document.getElementById('show-stdresid-btn').style.display = 'none';
  const table = document.getElementById('data-table');
  const expected = window._lastExpected;
  const r = window._lastValidRows;
  const c = window._lastValidCols;

  for (let i = 1; i <= r; i++) {
    for (let j = 1; j <= c; j++) {
      const cell = table.rows[i].cells[j];
      if (cell && !cell.innerHTML.includes('stdresid')) {
        const O = parseFloat(cell.firstChild.value);
        const E = expected[i - 1][j - 1];
        const stdresid = E > 0 ? (O - E) / Math.sqrt(E) : 0;
        const display = document.createElement('div');
        display.className = 'expected';
        display.textContent = `(${stdresid.toFixed(3)})`;
        cell.appendChild(display);
      }
    }
  }
  updateLegend(['Count'].concat(Object.entries(window._shownMetrics).filter(([k, v]) => v).map(([k]) => {
  return {
    expected: 'Expected',
    contrib: 'Contribution',
    resid: 'Residual',
    stdresid: 'Standardized Residual'
  }[k];
})));
}

function toggleOverlay(type) {
  const table = document.getElementById('data-table');
  const expected = window._lastExpected;
  const r = window._lastValidRows;
  const c = window._lastValidCols;
  const checkbox = document.getElementById(`toggle-${type}`);
  const labels = {
    expected: 'Expected',
    contrib: 'Chi-Square Contribution',
    resid: 'Chi-Square Residual',
    stdresid: 'Standardized Residual'
  };

  for (let i = 1; i <= r; i++) {
    for (let j = 1; j <= c; j++) {
      const cell = table.rows[i].cells[j];
      const markerClass = `overlay-${type}`;
      if (!cell) continue;

      const existing = cell.querySelector(`.${markerClass}`);
      if (existing) cell.removeChild(existing);

      if (checkbox.checked) {
        let value;
        const O = parseFloat(cell.firstChild.value);
        const E = expected[i - 1][j - 1];
        if (type === 'expected') value = E.toFixed(3);
        else if (type === 'contrib') value = E > 0 ? (Math.pow(O - E, 2) / E).toFixed(2) : '0.00';
        else if (type === 'resid') value = (O - E).toFixed(2);
        else if (type === 'stdresid') value = E > 0 ? ((O - E) / Math.sqrt(E)).toFixed(2) : '0.00';

        const div = document.createElement('div');
        div.className = `expected overlay-${type}`;
        div.textContent = `(${value})`;
        let overlays = Array.from(cell.querySelectorAll('div.expected'));
        overlays.push(div);
        overlays = [
          overlays.find(el => el.classList.contains('overlay-expected')),
          overlays.find(el => el.classList.contains('overlay-contrib')),
          overlays.find(el => el.classList.contains('overlay-resid')),
          overlays.find(el => el.classList.contains('overlay-stdresid'))
        ].filter(Boolean);
        cell.querySelectorAll('div.expected').forEach(e => cell.removeChild(e));
        overlays.forEach(e => cell.appendChild(e));
      }
    }
  }

  const order = ['expected', 'contrib', 'resid', 'stdresid'];
  const shown = order.filter(key => document.getElementById(`toggle-${key}`).checked);
  const legendLabels = ['Count'].concat(shown.map(key => labels[key]));
  updateLegend(legendLabels);
}

createTable();
</script>
    </div>
<!-- End full GUI wrapper -->
  </div>
</body>
</html>

</template>
  <template id="TPL_GOF" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chi-Square Goodness of Fit Test</title>
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      padding: 40px;
      background-color: white;
    }
    .container {
      border: 2px solid #ccc;
      border-radius: 12px;
      padding: 30px;
      max-width: 700px;
      width: 100%;
      background-color: #fafafa;
      text-align: center;
    }
    .table-wrapper {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      position: relative;
    }
    .table-controls {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-right: 10px;
      margin-top: 48px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    .cell-input {
      width: 100px;
      text-align: center;
      padding: 4px;
    }
    button {
      padding: 6px 12px;
      margin: 5px;
      border: 1px solid #ccc;
      background-color: #e7e7e7;
      cursor: pointer;
      font-size: 14px;
      border-radius: 4px;
    }
    button:hover {
      background-color: #d5d5d5;
    }
    .result-box {
      background-color: #f4f4f4;
      padding: 15px;
      margin-top: 20px;
      border-radius: 6px;
      text-align: center;
    }
    .equal-control {
      margin-top: 10px;
      text-align: right;
    }
  .shake {
      animation: shake 0.5s;
    }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }
</style>
</head>
<body>
<div class="container mt-4 text-center">
  <h3>Chi-Square Goodness of Fit Test</h3>
  <div style="margin-bottom: 10px;">
    <label for="alphaInput">Significance Level: α = </label>
    <input type="number" id="alphaInput" value="0.05" step="0.001" min="0" max="1" style="width: 80px;">
  </div>
  <button onclick="fullReset()">Reset</button>

  <div class="table-wrapper">
    <div class="table-controls">
      <button onclick="removeRow()">−</button>
      <button onclick="addRow()">+</button>
    </div>

    <div style="width: 100%;">
      <table class="table table-bordered text-center">
        <thead>
          <tr>
            <th>Category</th>
            <th>Observed</th>
            <th>Expected</th>
          </tr>
        </thead>
        <tbody id="data-table"></tbody>
      </table>
      <div class="equal-control">
        <button onclick="equalProportion()">Equal Proportion</button>
      </div>
    </div>
  </div>

  <button id="calculateBtn" onclick="calculateChiSquare()" disabled>Calculate</button>
  <div id="checkbox-controls"></div>
  <div id="results" class="result-box mx-auto" style="max-width: 300px; margin-left: auto; margin-right: auto; display: none;"></div>
  <div id="message" style="display:none; margin-top:10px; color:red; font-weight:bold;"></div>
</div>
<script>
  let rowCount = 6;
  const minRows = 2;

  function createTable() {
    let table = document.getElementById('data-table');
    table.innerHTML = '';
    for (let i = 1; i <= rowCount; i++) {
      table.innerHTML += `<tr>
        <td contenteditable="true">Category ${i}</td>
        <td><input type="number" class="cell-input form-control" min="0"></td>
        <td><input type="number" class="cell-input form-control" min="0"></td>
      </tr>`;
    }
  }

  function addRow() {
    let table = document.getElementById('data-table');
    let existingData = Array.from(table.rows).map(row => [
      row.cells[0].innerText,
      row.cells[1].querySelector('input').value,
      row.cells[2].querySelector('input').value
    ]);
    rowCount++;
    createTable();
    existingData.forEach((row, i) => {
      if (i < rowCount - 1) {
        table.rows[i].cells[0].innerText = row[0];
        table.rows[i].cells[1].querySelector('input').value = row[1];
        table.rows[i].cells[2].querySelector('input').value = row[2];
      }
    });
  }

  function removeRow() {
    if (rowCount > minRows) {
      let table = document.getElementById('data-table');
      let existingData = Array.from(table.rows).map(row => [
        row.cells[0].innerText,
        row.cells[1].querySelector('input').value,
        row.cells[2].querySelector('input').value
      ]);
      rowCount--;
      createTable();
      existingData.slice(0, rowCount).forEach((row, i) => {
        table.rows[i].cells[0].innerText = row[0];
        table.rows[i].cells[1].querySelector('input').value = row[1];
        table.rows[i].cells[2].querySelector('input').value = row[2];
      });
    }
  }

  function equalProportion() {
    const observedInputs = document.querySelectorAll('tbody tr td:nth-child(2) input');
    const expectedInputs = document.querySelectorAll('tbody tr td:nth-child(3) input');
    let totalObserved = 0;
    let validCount = 0;
    observedInputs.forEach(input => {
      const value = parseFloat(input.value);
      if (!isNaN(value)) {
        totalObserved += value;
        validCount++;
      }
    });
    const equalValue = totalObserved / validCount;
    observedInputs.forEach((input, index) => {
      const obs = parseFloat(input.value);
      if (!isNaN(obs)) {
        expectedInputs[index].value = equalValue.toFixed(6);
      } else {
        expectedInputs[index].value = '';
      }
    });
  }

  let calculatedOnce = false;

function calculateChiSquare() {
    const observedInputs = document.querySelectorAll('tbody tr td:nth-child(2) input');
    const expectedInputs = document.querySelectorAll('tbody tr td:nth-child(3) input');
    const tableRows = document.querySelectorAll('tbody tr');

    // Validate first
    for (let i = 0; i < tableRows.length; i++) {
      let obs = parseFloat(observedInputs[i].value);
      let exp = parseFloat(expectedInputs[i].value);

      if (isNaN(obs)) continue; // skip row deletion here
      if (isNaN(exp) || exp === 0) {
        showMessage('Please complete the expected values or use the autofill option.');
        return;
      }
    }

    // Clear prior extra columns and checkbox UI
    document.getElementById('checkbox-controls').innerHTML = '';
    const headers = document.querySelector('thead tr');
    ['col-expected', 'col-residual', 'col-standardized', 'col-contrib'].forEach(colId => {
      const colIndex = Array.from(headers.cells).findIndex(cell => cell.dataset.colId === colId);
      if (colIndex !== -1) {
        headers.deleteCell(colIndex);
        Array.from(document.getElementById('data-table').rows).forEach(row => row.deleteCell(colIndex));
      }
    });

 let observed = [];
    let expected = [];

    for (let i = 0; i < tableRows.length; i++) {
      let obs = parseFloat(observedInputs[i].value);
      let exp = parseFloat(expectedInputs[i].value);
      if (isNaN(obs)) {
        tableRows[i].remove();
        rowCount--;
        continue;
      }
      if (isNaN(exp) || exp === 0) {
        showMessage('Expected values must be filled in and non-zero.');
        return;
      }
      observed.push(obs);
      expected.push(exp);
    }
      
    if (rowCount < minRows) {
      showMessage('At least two valid observed values are required.');
      location.reload();
      return;
    }
    const totalObserved = observed.reduce((a, b) => a + b, 0);
    const totalExpected = expected.reduce((a, b) => a + b, 0);
    if (Math.abs(totalObserved - totalExpected) > 0.5) {
      
      showMessage(`The total of observed values (${totalObserved}) does not match the total of expected values (${totalExpected.toFixed(2)}). These must be equal for a valid test.`);
      return;
    }
    let chiSquare = observed.reduce((acc, obs, idx) => acc + Math.pow(obs - expected[idx], 2) / expected[idx], 0);
    let df = rowCount - 1;
    let pValue = 1 - jStat.chisquare.cdf(chiSquare, df);
    let sampleSize = observed.reduce((a, b) => a + b, 0);
    const resultsBox = document.getElementById('results');
    if (!resultsBox) return;
    const alpha = parseFloat(document.getElementById('alphaInput').value);
    const pClass = pValue < alpha ? 'color:green;font-weight:bold;' : 'color:red;font-weight:bold;';
    const criticalValue = jStat.chisquare.inv(1 - alpha, df);
    resultsBox.innerHTML = `<strong>P-value:</strong> <span style="${pClass}">${pValue.toFixed(6)}</span><br>
      Chi-square statistic: ${chiSquare.toFixed(6)}<br><br>
      Critical Chi-Square Value: ${criticalValue.toFixed(6)}<br>
      Degrees of freedom (df): ${df}<br>
      Sample Size: ${sampleSize}`;
    resultsBox.style.display = 'block';
    resultsBox.classList.add('shake');
    setTimeout(() => resultsBox.classList.remove('shake'), 500);


    // Restore columns based on checked boxes
    const checkboxStates = {
  contrib: document.querySelector('input[type="checkbox"][onchange*="contrib"]')?.checked || false,
  residual: document.querySelector('input[type="checkbox"][onchange*="residual"]')?.checked || false,
  standardized: document.querySelector('input[type="checkbox"][onchange*="standardized"]')?.checked || false
};
    for (let key in checkboxStates) {
      const desired = checkboxStates[key];
      const columnId = `col-${key}`;
      const alreadyVisible = document.querySelector(`th[data-col-id="${columnId}"]`) !== null;
      if (desired && !alreadyVisible) toggleExtraColumn(key);
      if (!desired && alreadyVisible) toggleExtraColumn(key);
    }

    // Place checkboxes
    const controls = document.createElement('div');
    controls.className = 'd-flex justify-content-center gap-4 mt-3 flex-wrap';
    controls.innerHTML = `
      <label><input type="checkbox" onchange="toggleExtraColumn('contrib')"> Chi-Square Contributions</label>
      <label><input type="checkbox" onchange="toggleExtraColumn('residual')"> Residuals</label>
      <label><input type="checkbox" onchange="toggleExtraColumn('standardized')"> Standardized Residuals</label>
    `;
    const insertLocation = document.getElementById('checkbox-controls');
    insertLocation.innerHTML = '';
    insertLocation.appendChild(controls);

    const table = document.getElementById('data-table');
    for (let i = 0; i < rowCount; i++) {
      const obs = observed[i];
      const exp = expected[i];
      const residual = obs - exp;
      const standardized = residual / Math.sqrt(exp);
      const contrib = Math.pow(obs - exp, 2) / exp;
      table.rows[i].setAttribute('data-expected', exp.toFixed(3));
      table.rows[i].setAttribute('data-residual', residual.toFixed(3));
      table.rows[i].setAttribute('data-standardized', standardized.toFixed(3));
      table.rows[i].setAttribute('data-contrib', contrib.toFixed(3));
    }
  }

  function toggleExtraColumn(type) {
    const table = document.getElementById('data-table');
    const headers = document.querySelector('thead tr');
    const columnMap = {
    'expected': 'Expected',
    'residual': 'Residual',
    'standardized': 'Std. Residual',
    'contrib': 'χ² Contrib.'
  };
    const columnId = `col-${type}`;
    const existingIndex = Array.from(headers.cells).findIndex(cell => cell.dataset.colId === columnId);
    if (existingIndex === -1) {
      const th = document.createElement('th');
      th.textContent = columnMap[type];
      th.dataset.colId = columnId;
      headers.appendChild(th);
      for (let row of table.rows) {
        const td = document.createElement('td');
        td.textContent = row.getAttribute(`data-${type}`);
        td.dataset.colId = columnId;
        row.appendChild(td);
      }
    } else {
      headers.deleteCell(existingIndex);
      for (let row of table.rows) {
        row.deleteCell(existingIndex);
      }
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    createTable();
    monitorInputValidity();
});
function fullReset() {
  const tableBody = document.getElementById("data-table");
  tableBody.innerHTML = "";

  rowCount = 6;
  for (let i = 1; i <= rowCount; i++) {
    const row = document.createElement("tr");

    const labelCell = document.createElement("td");
    labelCell.innerText = "Category " + i;
    row.appendChild(labelCell);

    const obsCell = document.createElement("td");
    const obsInput = document.createElement("input");
    obsInput.type = "number";
    obsInput.className = "cell-input";
    obsInput.min = "0";
    obsCell.appendChild(obsInput);
    row.appendChild(obsCell);

    const expCell = document.createElement("td");
    const expInput = document.createElement("input");
    expInput.type = "number";
    expInput.className = "cell-input";
    expInput.min = "0";
    expCell.appendChild(expInput);
    row.appendChild(expCell);

    tableBody.appendChild(row);
  }

  // Remove any extra columns (Residuals, Std. Residuals, Contributions)
  const headerRow = document.querySelector("thead tr");
  while (headerRow.children.length > 3) {
    headerRow.removeChild(headerRow.lastChild);
  }
  for (let row of tableBody.children) {
    while (row.children.length > 3) {
      row.removeChild(row.lastChild);
    }
  }

  // Reset extras
  document.getElementById("checkbox-controls").innerHTML = "";
  document.getElementById("results").style.display = "none";
  document.getElementById("results").innerHTML = "";
  document.getElementById("calculateBtn").disabled = true;
  document.getElementById("alphaInput").value = 0.05;
  calculatedOnce = false;
}

</script>
<script>
function showMessage(text) {
  const msgBox = document.getElementById('message');
  msgBox.textContent = text;
  msgBox.style.display = 'block';
  setTimeout(() => {
    msgBox.style.display = 'none';
  }, 5000);
 }
  
</script>
<script>
  function monitorInputValidity() {
    const table = document.getElementById('data-table');
    table.addEventListener('input', () => {
      if (calculatedOnce) {
        // Soft reset: hide results, clear checkboxes, remove extra columns
        document.getElementById('results').style.display = 'none';
        document.getElementById('checkbox-controls').innerHTML = '';
        const headers = document.querySelector('thead tr');
        ['col-expected', 'col-residual', 'col-standardized'].forEach(colId => {
          const colIndex = Array.from(headers.cells).findIndex(cell => cell.dataset.colId === colId);
          if (colIndex !== -1) {
            headers.deleteCell(colIndex);
            Array.from(document.getElementById('data-table').rows).forEach(row => row.deleteCell(colIndex));
          }
        });
        calculatedOnce = false;
        checkInput();
      }
    });
    const observer = new MutationObserver(checkInput);
    observer.observe(document.getElementById('data-table'), { childList: true, subtree: true });
    document.getElementById('data-table').addEventListener('input', checkInput);
  }

  function checkInput() {
    const observed = document.querySelectorAll('tbody tr td:nth-child(2) input');
    let validCount = 0;
    for (let i = 0; i < observed.length; i++) {
      if (!isNaN(parseFloat(observed[i].value))) {
        validCount++;
      }
    }
    document.getElementById('calculateBtn').disabled = validCount < 2;
  }
</script>
</body>
</html>

</template>

  <template id="TPL_DIST_REF" class="inline-tool">
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Probability Distributions Overview</title>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      vertical-align: top;
    }
    th {
      background-color: #f2f2f2;
      text-align: left;
    }
    td {
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>Probability Distributions Overview</h1>
  <table>
    <thead>
      <tr>
        <th>Distribution</th>
        <th>Description</th>
        <th>PDF/PMF Equation</th>
        <th>General Use Case</th>
        <th>Detailed Example</th>
      </tr>
    </thead>
    <tbody>
      <tr><td>Beta</td><td>A continuous distribution defined on the interval \( [0, 1] \), often used to model probabilities and proportions. Controlled by two shape parameters \( \alpha \) and \( \beta \).</td><td>\( f(x; \alpha, \beta) = \frac{x^{\alpha - 1}(1 - x)^{\beta - 1}}{B(\alpha, \beta)} \), for \( 0 < x < 1 \)</td><td>Modeling proportions and probabilities.</td><td>In digital marketing, an advertiser may estimate the probability that a user will click on an ad using a Beta distribution, updating beliefs as more data comes in.</td></tr>
      <tr><td>Chi-Square</td><td>A continuous distribution commonly used in hypothesis testing and confidence interval estimation for variance and categorical data.</td><td>\( f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2} \), for \( x > 0 \)</td><td>Analyzing categorical data and variability.</td><td>In a genetics study, a chi-square test can determine if the observed distribution of traits matches the expected Mendelian ratio.</td></tr>
      <tr><td>Cauchy</td><td>A continuous distribution with heavy tails and undefined mean and variance. It arises in ratios of normally distributed variables.</td><td>\( f(x; x_0, \gamma) = \frac{1}{\pi \gamma \left[1 + \left(\frac{x - x_0}{\gamma}\right)^2\right]} \)</td><td>Modeling resonance and peak effects.</td><td>In spectroscopy, the Cauchy distribution can model the shape of spectral lines affected by resonance broadening.</td></tr>
      <tr><td>Exponential</td><td>Models the time between independent events occurring at a constant rate. Memoryless property.</td><td>\( f(x; \lambda) = \lambda e^{-\lambda x},\ x \ge 0 \)</td><td>Modeling time until an event occurs.</td><td>A call center may use the exponential distribution to model the time between incoming customer support calls.</td></tr>
      <tr><td>F</td><td>A ratio of two scaled chi-square distributions, used primarily in analysis of variance (ANOVA).</td><td>\( f(x; d_1, d_2) = \frac{(d_1 x)^{d_1/2} d_2^{d_2/2}}{x (d_1 x + d_2)^{(d_1 + d_2)/2} B(d_1/2, d_2/2)} \)</td><td>Comparing variability across groups.</td><td>In an educational study, an F-test may compare student test score variances across different teaching methods.</td></tr>
      <tr><td>Gamma</td><td>A two-parameter family of continuous distributions useful for modeling waiting times.</td><td>\( f(x; \alpha, \beta) = \frac{\beta^\alpha x^{\alpha - 1} e^{-\beta x}}{\Gamma(\alpha)} \)</td><td>Modeling positive continuous data with skew.</td><td>An insurance company uses the Gamma distribution to model the size and frequency of claims filed in a given period.</td></tr>
      <tr><td>Lognormal</td><td>A distribution of a variable whose logarithm is normally distributed.</td><td>\( f(x; \mu, \sigma) = \frac{1}{x \sigma \sqrt{2\pi}} e^{-\frac{(\ln x - \mu)^2}{2\sigma^2}} \), \( x > 0 \)</td><td>Modeling skewed data with a lower bound.</td><td>Economists may use the lognormal distribution to estimate the distribution of household incomes within a region.</td></tr>
      <tr><td>Normal</td><td>A symmetric, bell-shaped distribution characterized by its mean and standard deviation.</td><td>\( f(x; \mu, \sigma) = \frac{1}{\sigma \sqrt{2\pi}} e^{-\frac{(x - \mu)^2}{2\sigma^2}} \)</td><td>Modeling symmetric natural variation.</td><td>In quality control, the normal distribution models the variability in manufacturing dimensions of a machined part.</td></tr>
      <tr><td>T-Distribution</td><td>A distribution used instead of the normal distribution when sample sizes are small and population standard deviation is unknown.</td><td>\( f(t; \nu) = \frac{\Gamma((\nu+1)/2)}{\sqrt{\nu \pi} \Gamma(\nu/2)} \left(1 + \frac{t^2}{\nu}\right)^{-(\nu+1)/2} \)</td><td>Estimating means from small samples.</td><td>A researcher uses the t-distribution to construct a confidence interval for the mean height of a plant species based on a small sample of 10 measurements.</td></tr>
      <tr><td>Uniform</td><td>A distribution where all outcomes are equally likely over a certain interval \( [a, b] \).</td><td>\( f(x) = \frac{1}{b - a},\ a \le x \le b \)</td><td>Modeling equally likely outcomes.</td><td>In simulations, software may generate random times between tasks using a uniform distribution between 1 and 5 minutes.</td></tr>
      <tr><td>Weibull</td><td>A flexible distribution used for modeling lifetimes and failure rates.</td><td>\( f(x; k, \lambda) = \frac{k}{\lambda} \left(\frac{x}{\lambda}\right)^{k - 1} e^{-(x/\lambda)^k} \)</td><td>Modeling life durations and reliability.</td><td>An engineer models the lifetime of ball bearings in an industrial machine using the Weibull distribution to predict maintenance schedules.</td></tr>
    </tbody>
  </table>
</body>
</html>

</template>
  <template id="TPL_EXCEL_REF" class="inline-tool">
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="Useful%20Excel%20Formulas_files/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Clark Metz</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Clark Metz</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>2</o:TotalTime>
  <o:Created>2025-11-12T15:11:00Z</o:Created>
  <o:LastSaved>2025-11-12T15:13:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>593</o:Words>
  <o:Characters>4038</o:Characters>
  <o:Lines>74</o:Lines>
  <o:Paragraphs>41</o:Paragraphs>
  <o:CharactersWithSpaces>4590</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="Useful%20Excel%20Formulas_files/themedata.thmx">
<link rel=colorSchemeMapping
href="Useful%20Excel%20Formulas_files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536869121 1107305727 33554432 0 415 0;}
@font-face
	{font-family:Aptos;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 3 0 0 415 0;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:-536869121 64767 1 0 415 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
h1
	{mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Heading 1 Char";
	mso-style-next:Normal;
	margin-top:.25in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 2 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 3 Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 4 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;
	font-style:italic;}
h5
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 5 Char";
	mso-style-next:Normal;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;}
h6
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 6 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 7 Char";
	mso-style-next:Normal;
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 8 Char";
	mso-style-next:Normal;
	margin:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Heading 9 Char";
	mso-style-next:Normal;
	margin:0in;
	line-height:115%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Title Char";
	mso-style-next:Normal;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Subtitle Char";
	mso-style-next:Normal;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:.5in;
	mso-add-space:auto;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Quote Char";
	mso-style-next:Normal;
	margin-top:8.0pt;
	margin-right:0in;
	margin-bottom:8.0pt;
	margin-left:0in;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Intense Quote Char";
	mso-style-next:Normal;
	margin-top:.25in;
	margin-right:.6in;
	margin-bottom:.25in;
	margin-left:.6in;
	text-align:center;
	line-height:115%;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-top-alt:solid #0F4761 .5pt;
	mso-border-top-themecolor:accent1;
	mso-border-top-themeshade:191;
	mso-border-bottom-alt:solid #0F4761 .5pt;
	mso-border-bottom-themecolor:accent1;
	mso-border-bottom-themeshade:191;
	padding:0in;
	mso-padding-alt:10.0pt 0in 10.0pt 0in;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	font-style:italic;}
span.MsoIntenseEmphasis
	{mso-style-priority:21;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.MsoIntenseReference
	{mso-style-priority:32;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	font-variant:small-caps;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	letter-spacing:.25pt;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 1";
	mso-ansi-font-size:20.0pt;
	mso-bidi-font-size:20.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 2";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 3";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 4";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 5";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 6";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	font-style:italic;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 7";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 8";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Heading 9";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Title;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Aptos Display",sans-serif;
	mso-ascii-font-family:"Aptos Display";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Aptos Display";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;}
span.SubtitleChar
	{mso-style-name:"Subtitle Char";
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Subtitle;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;}
span.QuoteChar
	{mso-style-name:"Quote Char";
	mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Quote;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	font-style:italic;}
span.IntenseQuoteChar
	{mso-style-name:"Intense Quote Char";
	mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Intense Quote";
	color:#0F4761;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Aptos;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
.MsoPapDefault
	{mso-style-type:export-only;
	margin-bottom:8.0pt;
	line-height:115%;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
 /* List Definitions */
 @list l0
	{mso-list-id:559050843;
	mso-list-template-ids:1716948362;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l0:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1
	{mso-list-id:1153109354;
	mso-list-template-ids:-1338600440;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l1:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2
	{mso-list-id:1659918401;
	mso-list-template-ids:540334598;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l2:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l2:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3
	{mso-list-id:1763405629;
	mso-list-template-ids:-1612805586;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l3:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l3:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4
	{mso-list-id:2065642418;
	mso-list-template-ids:-91074004;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l4:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l4:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level5
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:2.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level6
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level7
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:3.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level8
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level9
	{mso-level-number-format:bullet;
	mso-level-text:\F0A7;
	mso-level-tab-stop:4.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo1
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo2
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo3
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo4
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo5
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo6
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo7
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo8
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo9
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l0:level1 lfo10
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level1 lfo11
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level1 lfo12
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level1 lfo13
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level1 lfo14
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l4:level1 lfo15
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level1 lfo16
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level1 lfo17
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level1 lfo18
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l3:level1 lfo19
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level1 lfo20
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level1 lfo21
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level1 lfo22
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level1 lfo23
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level1 lfo24
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l2:level1 lfo25
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level1 lfo26
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level1 lfo27
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level1 lfo28
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level1 lfo29
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level1 lfo30
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
@list l1:level1 lfo31
	{mso-level-start-at:0;
	mso-level-numbering:continue;
	mso-level-text:\F0A7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Wingdings;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin-top:0in;
	mso-para-margin-right:0in;
	mso-para-margin-bottom:8.0pt;
	mso-para-margin-left:0in;
	line-height:115%;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Aptos",sans-serif;
	mso-ascii-font-family:Aptos;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Aptos;
	mso-hansi-theme-font:minor-latin;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in;word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><u>Useful Excel Formulas</u><b><o:p></o:p></b></p>

<p class=MsoNormal>Descriptive Statistics:<b><o:p></o:p></b></p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo1;tab-stops:list .5in'><span
     class=GramE><span style='font-family:Consolas'>AVERAGE(</span></span><span
     style='font-family:Consolas'>number1, [number2], ...):</span> Calculates
     the arithmetic <span class=GramE>mean</span> of a range of numbers.
     Example: =<span class=GramE>AVERAGE(</span>A1:A10) calculates the average
     of the values in cells A1 through A10.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     class=GramE><span style='font-family:Consolas'>MEDIAN(</span></span><span
     style='font-family:Consolas'>number1, [number2], ...):</span> Returns the
     median (middle value) of a range of numbers. Example: =<span class=GramE>MEDIAN(</span>B1:B5)<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo3;tab-stops:list .5in'>MODE.SNGL(number<span
     class=GramE>1,[</span>number2<span class=GramE>],...</span>): Returns the
     most frequently occurring number in a data set. For multiple modes, use MODE.MULT().
     Example: =MODE.SNGL(C1:C8)<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo4;tab-stops:list .5in'>STDEV.S(number<span
     class=GramE>1,[</span>number2<span class=GramE>],...</span>): Calculates
     the sample standard deviation. Use STDEV.P() for population standard
     deviation. Example: =STDEV.S(D1:D20)<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo5;tab-stops:list .5in'>VAR.S(number<span
     class=GramE>1,[</span>number2<span class=GramE>],...</span>): Calculates
     the sample variance. Use VAR.P() for population variance. Example: =VAR.S(E1:E15)<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo6;tab-stops:list .5in'><span
     class=GramE>QUARTILE.INC(<span class=SpellE>array,quart</span></span>):
     Returns the quartile of a dataset. quart is 1, 2, or 3 for the 25th, 50th
     (median), or 75th percentile, respectively. Example: =<span class=GramE>QUARTILE.INC(</span>A1:A10,1)
     for the first quartile.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo7;tab-stops:list .5in'><span
     class=GramE>PERCENTILE.INC(<span class=SpellE>array,k</span></span>):
     Returns the k-<span class=SpellE>th</span> percentile of values in a
     range, where k is between 0 and 1 inclusive. Example: =<span class=GramE>PERCENTILE.INC(</span>A1:A10,0.5)
     for the 50th percentile (median).<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo8;tab-stops:list .5in'><span
     class=GramE>COUNT(</span>value1, [value2], ...): Counts the number of
     cells that contain numbers. Example: =<span class=GramE>COUNT(</span>A1:A10)<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo9;tab-stops:list .5in'><span
     class=GramE>COUNTIF(</span>range, criteria): Counts the number of cells
     within a range that <span class=GramE>meet</span> a given criterion.
     Example: =<span class=GramE>COUNTIF(</span>A1:A10,&quot;&gt;10&quot;)
     counts cells greater than 10.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l0 level1 lfo10;tab-stops:list .5in'><span
     class=GramE>FREQUENCY(</span><span class=SpellE>data_array</span>, <span
     class=SpellE>bins_array</span>): Calculates how often values occur within
     a range of values (bins) and returns a vertical array of numbers. This is
     useful for creating histograms. Requires selecting a range of cells for
     the output and entering the formula as an array formula (<span
     class=SpellE>Ctrl+Shift+Enter</span>).<o:p></o:p></li>
</ul>

<p class=MsoNormal>Probability:<b><o:p></o:p></b></p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l4 level1 lfo11;tab-stops:list .5in'><span
     class=GramE>RAND(</span>): Generates a random number between 0 and 1.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l4 level1 lfo12;tab-stops:list .5in'><span
     class=GramE>RANDBETWEEN(</span>bottom, top): Generates a random integer
     between the specified bottom and top values.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l4 level1 lfo13;tab-stops:list .5in'><span
     class=GramE>COMBIN(</span>number, <span class=SpellE>number_chosen</span>):
     Calculates the number of combinations (without regard to order). Example: =<span
     class=GramE>COMBIN(</span>5,2) calculates &quot;5 choose 2.&quot;<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l4 level1 lfo14;tab-stops:list .5in'><span
     class=GramE>PERMUT(</span>number, <span class=SpellE>number_chosen</span>):
     Calculates the number of permutations (<span class=GramE>with regard to</span>
     order). Example: =<span class=GramE>PERMUT(</span>5,2)<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l4 level1 lfo15;tab-stops:list .5in'>BINOM.DIST(<span
     class=SpellE>number_s</span>, trials, <span class=SpellE>probability_s</span>,
     cumulative): Returns the binomial probability distribution. If cumulative is
     TRUE, it returns the cumulative distribution function; if FALSE, it
     returns the probability mass function.<o:p></o:p></li>
</ul>

<p class=MsoNormal>Normal Distribution:<b><o:p></o:p></b></p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l3 level1 lfo16;tab-stops:list .5in'>NORM.DIST(x,
     mean, <span class=SpellE>standard_dev</span>, cumulative): Returns the
     normal distribution for the specified mean and standard deviation. If cumulative
     is TRUE, it returns the cumulative distribution function; if FALSE, it
     returns the probability density function.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l3 level1 lfo17;tab-stops:list .5in'><span
     class=GramE>NORM.S.DIST</span>(z, cumulative): Returns the standard normal
     distribution.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l3 level1 lfo18;tab-stops:list .5in'><span
     class=GramE>NORM.INV(</span>probability, mean, <span class=SpellE>standard_dev</span>):
     Returns the inverse of the normal cumulative distribution (useful for
     finding critical values).<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l3 level1 lfo19;tab-stops:list .5in'><span
     class=GramE>NORM.S.INV(</span>probability): Returns the inverse of the
     standard normal cumulative distribution.<o:p></o:p></li>
</ul>

<p class=MsoNormal>Inference (Confidence Intervals and Hypothesis Testing):<b><o:p></o:p></b></p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l2 level1 lfo20;tab-stops:list .5in'><span
     class=GramE>T.DIST</span>(<span class=SpellE><span class=GramE>x,deg</span>_<span
     class=GramE>freedom,cumulative</span></span>): Returns the Student's
     t-distribution.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l2 level1 lfo21;tab-stops:list .5in'><span
     class=GramE>T.INV(<span class=SpellE>probability,deg</span></span><span
     class=SpellE>_freedom</span>): Returns the inverse of the <span
     class=GramE>Student's</span> t-distribution (for two-tailed tests, use
     1-probability/2).<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l2 level1 lfo22;tab-stops:list .5in'>T.<span
     class=GramE>TEST(</span>array<span class=GramE>1,array2,tails</span>,type):
     Performs a t-test. tails <span class=GramE>is</span> 1 or 2 for one-tailed
     or two-tailed tests. type <span class=GramE>specifies</span> the type of
     t-test (1=paired, 2=two-sample equal variance, 3=two-sample unequal
     variance).<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l2 level1 lfo23;tab-stops:list .5in'>CHISQ.TEST(<span
     class=SpellE>actual_<span class=GramE>range,expected</span>_range</span>):
     Performs a chi-square test of independence.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l2 level1 lfo24;tab-stops:list .5in'>CHISQ.DIST(<span
     class=SpellE><span class=GramE>x,deg</span>_<span class=GramE>freedom,cumulative</span></span>):
     Returns the chi-squared distribution.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l2 level1 lfo25;tab-stops:list .5in'><span
     class=GramE>CHISQ.INV(<span class=SpellE>probability,deg</span></span><span
     class=SpellE>_freedom</span>): Returns the inverse of the chi-squared
     distribution.<o:p></o:p></li>
</ul>

<p class=MsoNormal>Correlation and Regression:<b><o:p></o:p></b></p>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l1 level1 lfo26;tab-stops:list .5in'><span
     class=GramE>CORREL(</span>array1, array2): Calculates the Pearson
     correlation coefficient.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l1 level1 lfo27;tab-stops:list .5in'><span
     class=GramE>SLOPE(</span><span class=SpellE>known_y's</span>, <span
     class=SpellE>known_x's</span>): Calculates the slope of the linear
     regression line.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l1 level1 lfo28;tab-stops:list .5in'><span
     class=GramE>INTERCEPT(</span><span class=SpellE>known_y's</span>, <span
     class=SpellE>known_x's</span>): Calculates the y-intercept of the linear
     regression line.<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l1 level1 lfo29;tab-stops:list .5in'><span
     class=GramE>LINEST(</span><span class=SpellE>known_y's</span>, <span
     class=SpellE>known_x's</span>, [const], [stats]): Returns an array of
     regression statistics, including the slope, intercept, R-squared, and
     more. If const is TRUE or omitted, calculates the intercept; if FALSE,
     forces the intercept to be zero. If stats <span class=GramE>is</span>
     TRUE, <span class=GramE>returns</span> additional regression statistics.
     This is a powerful function but requires selecting a range of cells for
     the output and entering it as an array formula (<span class=SpellE>Ctrl+Shift+Enter</span>).<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l1 level1 lfo30;tab-stops:list .5in'>FORECAST.LINEAR(x,
     <span class=SpellE>known_y's</span>, <span class=SpellE>known_x's</span>):
     Calculates a predicted y-value for a given x-value based on the linear
     regression line. (In newer versions of Excel, this is <span class=GramE>FORECAST(</span>)).<o:p></o:p></li>
</ul>

<ul style='margin-top:0in' type=square>
 <li class=MsoNormal style='mso-list:l1 level1 lfo31;tab-stops:list .5in'><span
     class=GramE>RSQ(</span><span class=SpellE>known_y's</span>, <span
     class=SpellE>known_x's</span>): Calculates the R-squared value for a
     linear regression.<o:p></o:p></li>
</ul>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>

</template>

</body>
</html>
